webpackJsonp([2],{10:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(8),d=a(c),f=n(1),p=a(f),m={children:p.default.object.isRequired},h=document.getElementById("modal-wrapper"),Y=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.el=document.createElement("div"),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){h.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){h.removeChild(this.el)}},{key:"render",value:function(){return d.default.createPortal(this.props.children,this.el)}}]),t}(u.default.Component);Y.propTypes=m,t.default=Y},103:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function e(t){a(this,e),this.id=t.repo_tag_id,this.fileCount=t.files_count,this.name=t.tag_name,this.color=t.tag_color};t.default=o},106:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(2),m=n(3),h=n(4),Y=n(103),Z=a(Y);n(113);var S={repoID:d.default.string.isRequired,repoTag:d.default.object.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,onEditFileTag:d.default.func.isRequired},L=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({showSelectedTag:!0})},n.onMouseLeave=function(){n.setState({showSelectedTag:!1})},n.getRepoTagIdList=function(){var e=[];return n.props.fileTagList.map(function(t){e.push(t.repo_tag_id)}),e},n.onEditFileTag=function(){var e=n.props,t=e.repoID,a=e.repoTag,o=e.filePath,r=n.getRepoTagIdList();if(-1===r.indexOf(a.id)){var i=a.id;m.seafileAPI.addFileTag(t,o,i).then(function(){r=n.getRepoTagIdList(),n.props.onEditFileTag()})}else{for(var s=null,l=n.props.fileTagList,u=0;u<l.length;u++)if(l[u].repo_tag_id===a.id){s=l[u];break}m.seafileAPI.deleteFileTag(t,s.id).then(function(){r=n.getRepoTagIdList(),n.props.onEditFileTag()})}},n.state={showSelectedTag:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.repoTag,t=this.getRepoTagIdList(),n=h.Utils.getDarkColor(e.color);return u.default.createElement("li",{key:e.id,className:"tag-list-item",onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("div",{className:"tag-demo",style:{backgroundColor:e.color}},u.default.createElement("span",{className:this.state.showSelectedTag?"show-tag-selected":"",style:{backgroundColor:n}}),u.default.createElement("span",{className:"tag-name"},e.name),t.indexOf(e.id)>-1&&u.default.createElement("i",{className:"fas fa-check tag-operation"})))}}]),t}(u.default.Component);L.propTypes=S;var C={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,toggleCancel:d.default.func.isRequired},g=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getRepoTagList=function(){var e=n.props.repoID;m.seafileAPI.listRepoTags(e).then(function(e){var t=[];e.data.repo_tags.forEach(function(e){var n=new Z.default(e);t.push(n)}),n.setState({repotagList:t})})},n.toggle=function(){n.props.toggleCancel()},n.onEditFileTag=function(){n.props.onFileTagChanged()},n.state={repotagList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getRepoTagList()}},{key:"render",value:function(){var e=this;return u.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(f.ModalHeader,{toggle:this.toggle},(0,p.gettext)("Select Tags")),u.default.createElement(f.ModalBody,null,u.default.createElement("ul",{className:"tag-list tag-list-container"},this.state.repotagList.map(function(t){return u.default.createElement(L,{key:t.id,repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onEditFileTag:e.onEditFileTag})}))),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{onClick:this.toggle},(0,p.gettext)("Close"))))}}]),t}(u.default.Component);g.propTypes=C,t.default=g},107:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(159),m=a(p),h=n(160),Y=a(h),Z=n(10),S=a(Z),L={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,dirent:d.default.object.isRequired,relatedFiles:d.default.array,viewMode:d.default.oneOf(["list_related_file","add_related_file"]).isRequired},C=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onAddRelatedFileToggle=function(){n.setState({showListRelatedFileDialog:!1})},n.onCloseAddRelatedFileDialog=function(){n.setState({showListRelatedFileDialog:!0})},n.state={showListRelatedFileDialog:"list_related_file"===e.viewMode},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(S.default,null,u.default.createElement(f.Modal,{isOpen:!0,toggle:this.props.toggleCancel,size:"lg",style:{width:"650px"}},this.state.showListRelatedFileDialog&&u.default.createElement(Y.default,{filePath:this.props.filePath,relatedFiles:this.props.relatedFiles,repoID:this.props.repoID,toggleCancel:this.props.toggleCancel,addRelatedFileToggle:this.onAddRelatedFileToggle,onRelatedFileChange:this.props.onRelatedFileChange}),!this.state.showListRelatedFileDialog&&u.default.createElement(m.default,{filePath:this.props.filePath,repoID:this.props.repoID,toggleCancel:this.onCloseAddRelatedFileDialog,onRelatedFileChange:this.props.onRelatedFileChange,dirent:this.props.dirent,onClose:this.props.toggleCancel})))}}]),t}(u.default.Component);C.propTypes=L,t.default=C},1079:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(82),m=n(2);n(1080);var h={editorUtilities:d.default.object.isRequired,quote:d.default.string.isRequired,commentPosition:d.default.object.isRequired,onCommentAdded:d.default.func.isRequired,toggleCommentDialog:d.default.func.isRequired},Y=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCommentChange=function(e){var t=e.target.value;n.setState({comment:t})},n.submitComment=function(){var e=n.state.comment.trim();if(e.length>0&&n.props.quote.length>0){var t={quote:n.props.quote,position:n.props.commentPosition},a=JSON.stringify(t);n.props.editorUtilities.postComment(e,a).then(function(e){n.props.onCommentAdded()})}},n.setQuoteText=function(e){p.processor.process(e).then(function(e){var t=String(e);n.setState({quote:t})})},n.state={comment:"",quote:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.setQuoteText(this.props.quote)}},{key:"componentWillReceiveProps",value:function(e){this.props.quote!==e.quote&&this.setQuoteText(e.quote)}},{key:"render",value:function(){return u.default.createElement("div",{className:"comment-dialog"},u.default.createElement("div",null,this.props.editorUtilities.name),u.default.createElement("blockquote",{className:"comment-dialog-quote"},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.quote}})),u.default.createElement("textarea",{value:this.state.comment,onChange:this.handleCommentChange}),u.default.createElement("div",{className:"button-group"},u.default.createElement(f.Button,{size:"sm",color:"primary",onClick:this.submitComment},(0,m.gettext)("Submit")),u.default.createElement(f.Button,{size:"sm",color:"secondary",onClick:this.props.toggleCommentDialog},(0,m.gettext)("Cancel"))),u.default.createElement("span",{className:"comment-dialog-triangle"}))}}]),t}(u.default.Component);Y.propTypes=h,t.default=Y},1080:function(e,t){},1081:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(2),m=(n(4),n(30)),h=a(m),Y={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,getInsertLink:d.default.func.isRequired},Z=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleInsert=function(){n.props.getInsertLink(n.state.repo.repo_id,n.state.selectedPath),n.props.toggleCancel()},n.onDirentItemClick=function(e,t,a){"file"===a.type?n.setState({repo:e,selectedPath:t}):n.setState({repo:null,selectedPath:""})},n.onRepoItemClick=function(){n.setState({repo:null,selectedPath:""})},n.state={repo:null,selectedPath:""},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.toggleCancel;return u.default.createElement(f.Modal,{isOpen:!0,toggle:e},u.default.createElement(f.ModalHeader,{toggle:e},(0,p.gettext)("Select File")),u.default.createElement(f.ModalBody,null,u.default.createElement(h.default,{isShowFile:!0,repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"current_repo_and_other_repos"})),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:e},(0,p.gettext)("Cancel")),this.state.selectedPath?u.default.createElement(f.Button,{color:"primary",onClick:this.handleInsert},(0,p.gettext)("Submit")):u.default.createElement(f.Button,{color:"primary",disabled:!0},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);Z.propTypes=Y,t.default=Z},1084:function(e,t){},1096:function(e,t){},1099:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(2),p=n(5),m={deleteDraft:d.default.func.isRequired,useDraft:d.default.func.isRequired,localDraftDialog:d.default.bool.isRequired,closeDraftDialog:d.default.func.isRequired},h=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.closeDraftDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.closeDraftDialog},(0,f.gettext)("Local draft")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",null,(0,f.gettext)("You have an unsaved draft. Do you like to use it?"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"primary",onClick:this.props.useDraft},(0,f.gettext)("Use draft")),u.default.createElement(p.Button,{color:"secondary",onClick:this.props.deleteDraft},(0,f.gettext)("Delete draft"))))}}]),t}(u.default.PureComponent);h.propTypes=m,t.default=h},11:function(e,t,n){"use strict";function a(){return r.default.createElement("span",{className:"loading-icon loading-tip"})}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=a},1103:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(2),p=n(234),m=n(235),h=a(m),Y={isDocs:d.default.bool.isRequired,hasDraft:d.default.bool.isRequired,isDraft:d.default.bool.isRequired,editorUtilities:d.default.object.isRequired,collabUsers:d.default.array.isRequired,fileInfo:d.default.object.isRequired,fileTagList:d.default.array.isRequired,relatedFiles:d.default.array.isRequired,toggleShareLinkDialog:d.default.func.isRequired,onEdit:d.default.func.isRequired,toggleNewDraft:d.default.func.isRequired,toggleStar:d.default.func.isRequired,backToParentDirectory:d.default.func.isRequired,openDialogs:d.default.func.isRequired,showFileHistory:d.default.bool.isRequired,toggleHistory:d.default.func.isRequired,commentsNumber:d.default.number.isRequired,toggleCommentList:d.default.func.isRequired},Z=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"renderFirstToolbar",value:function(){return u.default.createElement("div",{className:"sf-md-viewer-topbar-first d-flex justify-content-between"},u.default.createElement(h.default,{toggleStar:this.props.toggleStar,editorUtilities:this.props.editorUtilities,fileInfo:this.props.fileInfo}),this.props.hasDraft&&!this.props.isDraft&&u.default.createElement("div",{className:"seafile-btn-view-review"},u.default.createElement("div",{className:"tag tag-green"},(0,f.gettext)("This file is in draft stage."),u.default.createElement("a",{className:"ml-2",onMouseDown:this.props.editorUtilities.goDraftPage},(0,f.gettext)("View Draft")))),u.default.createElement("div",{className:"topbar-btn-container"},!this.props.hasDraft&&!this.props.isDraft&&this.props.isDocs&&u.default.createElement("button",{onMouseDown:this.props.toggleNewDraft,className:"btn btn-success btn-new-draft"},(0,f.gettext)("New Draft")),this.props.collabUsers.length>0&&u.default.createElement(p.CollabUsersButton,{className:"collab-users-dropdown",users:this.props.collabUsers,id:"usersButton"}),u.default.createElement(p.ButtonGroup,null,u.default.createElement(p.IconButton,{id:"shareBtn",text:(0,f.gettext)("Share"),icon:"fa fa-share-alt",onMouseDown:this.props.toggleShareLinkDialog}),this.props.commentsNumber>0?u.default.createElement("button",{className:"btn btn-icon btn-secondary btn-active",id:"commentsNumber",type:"button","data-active":"false",onMouseDown:this.props.toggleCommentList},u.default.createElement("i",{className:"fa fa-comments"})," ",u.default.createElement("span",null,this.props.commentsNumber)):u.default.createElement(p.IconButton,{id:"commentsNumber",text:(0,f.gettext)("Comments"),icon:"fa fa-comments",onMouseDown:this.props.toggleCommentList}),u.default.createElement(p.IconButton,{text:(0,f.gettext)("Back to parent directory"),id:"parentDirectory",icon:"fa fa-folder-open",onMouseDown:this.props.backToParentDirectory}),this.props.hasDraft||"rw"!==this.props.fileInfo.permission?null:u.default.createElement(p.IconButton,{text:(0,f.gettext)("Edit"),id:"editButton",icon:"fa fa-edit",onMouseDown:this.props.onEdit}),this.props.showFileHistory&&u.default.createElement(p.IconButton,{id:"historyButton",text:(0,f.gettext)("File History"),onMouseDown:this.props.toggleHistory,icon:"fa fa-history"}))))}},{key:"renderSecondToolbar",value:function(){var e=this.props,t=e.relatedFiles,n=e.fileTagList,a=this.props.openDialogs,o="";if(t){var r=t.length;1===r?o=(0,f.gettext)("Related file"):r>1&&(o=(0,f.gettext)("Related files"))}return u.default.createElement("div",{className:"sf-md-viewer-topbar-second d-flex justify-content-center"},n&&(n.length>0?u.default.createElement("ul",{className:"sf-files-tags"},n.map(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return u.default.createElement("li",{key:t,className:"sf-files-tag"},u.default.createElement("span",{className:"file-tag-icon",style:{backgroundColor:e.tag_color}}),u.default.createElement("span",{className:"file-tag-name",title:e.tag_name},e.tag_name))}),u.default.createElement("li",{className:"sf-files-tag"},u.default.createElement("span",{className:"file-tag-name",onClick:a.bind(this,"tags")},(0,f.gettext)("Edit")))):u.default.createElement("span",{className:"no-file-tag edit-related-file",onClick:a.bind(this,"tags")},(0,f.gettext)("No tags"))),t&&u.default.createElement("div",{className:"sf-related-files-bar"},0===t.length?u.default.createElement("span",{className:"edit-related-file no-related-file",onClick:a.bind(this,"related_files")},(0,f.gettext)("No related files")):u.default.createElement(u.default.Fragment,null,u.default.createElement("a",{href:"#sf-releted-files"},t.length," ",o),u.default.createElement("span",{className:"edit-related-file",onClick:a.bind(this,"related_files")},(0,f.gettext)("Edit")))))}},{key:"render",value:function(){return u.default.createElement("div",{className:"sf-md-viewer-topbar"},this.renderFirstToolbar(),this.renderSecondToolbar())}}]),t}(u.default.Component);Z.propTypes=Y,t.default=Z},1104:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(1),f=a(d),p=n(158),m=a(p),h=n(11),Y=a(h),Z=n(6),S=a(Z),L=n(2);n(1105);var C={editorUtilities:f.default.object.isRequired,showDiffViewer:f.default.func.isRequired,setDiffViewerContent:f.default.func.isRequired,reloadDiffContent:f.default.func.isRequired},g=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(e,t,a,o){if(t===n.state.activeItem)return!1;n.props.reloadDiffContent(),n.setState({activeItem:t}),m.default.all([n.props.editorUtilities.getFileHistoryVersion(o.commit_id,o.path),n.props.editorUtilities.getFileHistoryVersion(a.commit_id,a.path)]).then(m.default.spread(function(e,t){m.default.all([n.props.editorUtilities.getFileContent(e.data),n.props.editorUtilities.getFileContent(t.data)]).then(m.default.spread(function(e,t){n.props.showDiffViewer(),n.props.setDiffViewerContent(e.data,t.data)}))}))},n.onScroll=function(e){var t=e.target.clientHeight,a=e.target.scrollHeight;if(t+e.target.scrollTop+1>=a&&n.state.totalReversionCount>n.perPage*n.state.currentPage){var r=n.state.currentPage+1;n.setState({currentPage:r,loading:!0}),n.props.editorUtilities.listFileHistoryRecords(r,n.perPage).then(function(e){var t=Object.assign([],n.state.historyList);n.setState({historyList:[].concat(o(t),o(e.data.data)),loading:!1})})}},n.perPage=25,n.state={historyList:[],activeItem:0,currentPage:1,totalReversionCount:0,loading:!1},n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;this.props.editorUtilities.listFileHistoryRecords(1,this.perPage).then(function(t){e.setState({historyList:t.data.data,totalReversionCount:t.data.total_count}),t.data.data.length>1?m.default.all([e.props.editorUtilities.getFileHistoryVersion(t.data.data[0].commit_id,t.data.data[0].path),e.props.editorUtilities.getFileHistoryVersion(t.data.data[1].commit_id,t.data.data[1].path)]).then(m.default.spread(function(t,n){m.default.all([e.props.editorUtilities.getFileContent(t.data),e.props.editorUtilities.getFileContent(n.data)]).then(m.default.spread(function(t,n){e.props.showDiffViewer(),e.props.setDiffViewerContent(t.data,n.data)}))})):e.props.editorUtilities.getFileHistoryVersion(t.data.data[0].commit_id,t.data.data[0].path).then(function(t){e.props.editorUtilities.getFileContent(t.data).then(function(t){e.props.showDiffViewer(),e.props.setDiffViewerContent(t.data,"")})})})}},{key:"render",value:function(){var e=this;return c.default.createElement("div",{className:"seafile-history-side-panel"},c.default.createElement("div",{className:"seafile-history-title"},c.default.createElement("div",{onClick:this.props.toggleHistoryPanel,className:"seafile-history-title-close"},c.default.createElement("i",{className:"fa fa-times-circle"})),c.default.createElement("div",{className:"seafile-history-title-text"},(0,L.gettext)("History Versions"))),c.default.createElement("ul",{onScroll:this.onScroll,className:"history-list-container"},this.state.historyList?this.state.historyList.map(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments[2],o=n+1;return o===a.length&&(o=n),c.default.createElement(J,{onClick:e.onClick,ctime:t.ctime,className:e.state.activeItem===n?"item-active":"",currentItem:t,name:t.creator_name,index:n,key:n,preItem:a[o]})}):c.default.createElement(Y.default,null),this.state.loading&&c.default.createElement("li",{className:"reloading-reversion"},c.default.createElement(Y.default,{style:{width:"0.5rem",margin:"0 auto",color:"#b0b0b0"}}))))}}]),t}(c.default.Component);g.propTypes=C;var X={ctime:f.default.string,onClick:f.default.func,index:f.default.number,preItem:f.default.object,currewntItem:f.default.object,name:f.default.string,className:f.default.string},J=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){var e=this,t=S.default.parseZone(this.props.ctime).format("YYYY-MM-DD HH:mm");return c.default.createElement("li",{onClick:function(t){return e.props.onClick(t,e.props.index,e.props.preItem,e.props.currentItem)},className:"history-item-container "+this.props.className},c.default.createElement("div",{className:"time"},t),c.default.createElement("div",{className:"owner"},c.default.createElement("i",{className:"fa fa-square"}),c.default.createElement("span",null,this.props.name)))}}]),t}(c.default.Component);J.propTypes=X,t.default=g},1105:function(e,t){},1106:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(2),p={scrollToNode:d.default.func.isRequired,node:d.default.object.isRequired,active:d.default.string.isRequired},m=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(e){n.props.scrollToNode(n.props.node)},n}return i(t,e),s(t,[{key:"render",value:function(){var e,t=this.props.node;return"header_two"===t.type?e="outline-h2":"header_three"===t.type&&(e="outline-h3"),e+=this.props.active,u.default.createElement("div",{className:e,key:t.key,onClick:this.onClick},t.text)}}]),t}(u.default.PureComponent);m.propTypes=p;var h={scrollToNode:d.default.func.isRequired,isViewer:d.default.bool.isRequired,document:d.default.object.isRequired,activeTitleIndex:d.default.number,value:d.default.object},Y=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.document,n=t.nodes.filter(function(e){return"header_two"===e.type||"header_three"===e.type});return u.default.createElement("div",{className:"seafile-editor-outline"},u.default.createElement("div",{className:"seafile-editor-outline-heading"},(0,f.gettext)("Contents")),n.size>0?n.map(function(t,n){var a=n===e.props.activeTitleIndex?" active":"";return u.default.createElement(m,{key:t.key,value:e.props.value,node:t,active:a,scrollToNode:e.props.scrollToNode})}):u.default.createElement("div",{className:"size-panel-no-content"},(0,f.gettext)("No outline")))}}]),t}(u.default.PureComponent);Y.propTypes=h,t.default=Y},1107:function(e,t){},113:function(e,t){},1132:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1133),r=a(o),i=n(1142),s=a(i),l=window.app.config.siteRoot;r.default.use(s.default).init({fallbackLng:"en",ns:["translations"],defaultNS:"translations",whitelist:["en","zh-CN","fr","de","cs","es","es-AR","es-MX","ru"],backend:{loadPath:l+"media/assets/frontend/locales/{{ lng }}/{{ ns }}.json"},debug:!1,interpolation:{escapeValue:!1},load:"currentOnly",react:{wait:!0}}),t.default=r.default},1146:function(e,t){},12:function(e,t,n){"use strict";"undefined"===typeof Promise&&(n(33).enable(),window.Promise=n(34)),n(28),Object.assign=n(20)},13:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.strChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY"},137:function(e,t){},14:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(6),s=a(i),l=n(4),u=n(24),c=a(u),d=function(){function e(t){if(o(this,e),this.id=t.id||"0000000000000000",this.name=t.name,this.type=t.type,this.mtime=t.mtime,this.mtime_relative=s.default.unix(t.mtime).fromNow(),this.permission=t.permission||"rw",this.isSelected=!1,this.starred=t.starred||!1,"file"===t.type){this.size=l.Utils.bytesToSize(t.size),this.is_locked=t.is_locked||!1,this.lock_time=t.lock_time||"",this.lock_owner=t.lock_owner||null,this.lock_owner_name=t.lock_owner_name||null,this.locked_by_me=t.locked_by_me||!1,this.modifier_name=t.modifier_name||"",this.modifier_email=t.modifier_email||"",this.modifier_contact_email=t.modifier_contact_email||"";var n=[];t.file_tags&&(n=t.file_tags.map(function(e){return new c.default(e)})),this.file_tags=n,t.encoded_thumbnail_src&&(this.encoded_thumbnail_src=t.encoded_thumbnail_src)}}return r(e,[{key:"clone",value:function(){return new e(this)}},{key:"isDir",value:function(){return"file"!==this.type}}]),e}();t.default=d},15:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=n(0),s=a(i),l=n(8),u=a(l),c=n(16),d=a(c),f="undefined"!==typeof window&&"undefined"!==typeof window.document,p=function e(){var t=this;if(o(this,e),this._bindNotify=function(e){t.notifyHandler=e},this._bindGetToasts=function(e){t.getToastsHandler=e},this._bindCloseAll=function(e){t.closeAllHandler=e},this.getToasts=function(){return t.getToastsHandler()},this.closeAll=function(){return t.closeAllHandler()},this.notify=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,r({},n,{intent:"none"}))},this.success=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,r({},n,{intent:"success"}))},this.warning=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,r({},n,{intent:"warning"}))},this.danger=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,r({},n,{intent:"danger"}))},f){var n=document.createElement("div");n.setAttribute("data-evergreen-toaster-container",""),document.body.appendChild(n),u.default.render(s.default.createElement(d.default,{bindNotify:this._bindNotify,bindGetToasts:this._bindGetToasts,bindCloseAll:this._bindCloseAll}),n)}};t.default=p},156:function(e,t){},159:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(2),m=n(3),h=n(4),Y=n(30),Z=a(Y);n(98);var S={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,dirent:d.default.object.isRequired,onClose:d.default.func},L=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.onAddRelatedFile()},n.onAddRelatedFile=function(){var e=n.state,t=e.repo,a=e.selectedPath,o=n.props.repoID,r=t.repo_id,i=n.props.filePath,s=a;if(o===r&&i===s){var l=(0,p.gettext)("Can not select self as a related file.");return void n.setState({errMessage:l})}m.seafileAPI.addRelatedFile(o,r,i,s).then(function(e){n.props.onRelatedFileChange(),n.toggle()}).catch(function(e){e.response&&n.setState({errMessage:e.response.data.error_msg})})},n.toggle=function(){n.props.toggleCancel()},n.onDirentItemClick=function(e,t,a){"file"===a.type?n.setState({repo:e,selectedPath:t}):n.setState({repo:null,selectedPath:""})},n.onRepoItemClick=function(e){n.setState({repo:null,selectedPath:""})},n.state={repo:null,selectedPath:"",isShowFile:!0,errMessage:""},n}return i(t,e),s(t,[{key:"render",value:function(){var e=(0,p.gettext)("Select related file for {placeholder}");return e=e.replace("{placeholder}",'<span class="op-target">'+h.Utils.HTMLescape(this.props.dirent.name)+"</span>"),u.default.createElement(l.Fragment,null,u.default.createElement(f.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.toggle,"aria-label":(0,p.gettext)("Back")}),(0,p.gettext)("Select File")),u.default.createElement(f.ModalBody,null,u.default.createElement("div",{className:"related-file-subtitle",dangerouslySetInnerHTML:{__html:e}}),u.default.createElement(Z.default,{isShowFile:this.state.isShowFile,repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"current_repo_and_other_repos"}),this.state.errMessage&&u.default.createElement(f.Alert,{color:"danger"},this.state.errMessage)),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),this.state.selectedPath?u.default.createElement(f.Button,{color:"primary",onClick:this.handleSubmit},(0,p.gettext)("Submit")):u.default.createElement(f.Button,{color:"primary",disabled:!0},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);L.propTypes=S,t.default=L},16:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(0),f=a(d),p=n(9),m=n(1),h=a(m),Y=n(17),Z=a(Y),S=(0,p.css)({maxWidth:560,margin:"0 auto",top:0,left:0,right:0,position:"fixed",zIndex:999999}),L=function(e){return Object.hasOwnProperty.call(e,"id")},C=function(e){function t(e,n){i(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.getToasts=function(){return a.state.toasts},a.closeAll=function(){a.getToasts().forEach(function(e){return e.close()})},a.notify=function(e,t){if(L(t)){var n=!0,o=!1,i=void 0;try{for(var s,l=a.state.toasts[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;String(u.id).startsWith(t.id)&&a.closeToast(u.id)}}catch(e){o=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw i}}}var c=a.createToastInstance(e,t);return a.setState(function(e){return{toasts:[c].concat(r(e.toasts))}}),c},a.createToastInstance=function(e,n){var o=++t.idCounter,r=L(n)?n.id+"-"+o:o;return{id:r,title:e,description:n.description,hasCloseButton:n.hasCloseButton||!0,duration:n.duration||2,close:function(){return a.closeToast(r)},intent:n.intent}},a.closeToast=function(e){a.setState(function(t){return{toasts:t.toasts.map(function(t){return t.id===e?u({},t,{isShown:!1}):t})}})},a.removeToast=function(e){a.setState(function(t){return{toasts:t.toasts.filter(function(t){return t.id!==e})}})},e.bindNotify(a.notify),e.bindGetToasts(a.getToasts),e.bindCloseAll(a.closeAll),a.state={toasts:[]},a}return l(t,e),c(t,[{key:"render",value:function(){var e=this;return f.default.createElement("span",{className:S},this.state.toasts.map(function(t){var n=t.id,a=t.description,r=o(t,["id","description"]);return f.default.createElement(Z.default,u({key:n,onRemove:function(){return e.removeToast(n)}},r),a)}))}}]),t}(f.default.PureComponent);C.propTypes={bindNotify:h.default.func.isRequired,bindGetToasts:h.default.func.isRequired,bindCloseAll:h.default.func.isRequired},C.idCounter=0,t.default=C},160:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(14),m=a(p),h=n(2),Y=n(4),Z=n(3);n(161);var S={relatedFiles:d.default.array.isRequired,repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,addRelatedFileToggle:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired},L=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDeleteRelatedFile=function(e){var t=n.props.filePath,a=n.props.repoID,o=e.related_id;Z.seafileAPI.deleteRelatedFile(a,t,o).then(function(e){n.props.onRelatedFileChange()})},n.toggle=function(){n.props.toggleCancel()},n.getDirentList=function(e){if(0===e.length)return void n.setState({direntList:[]});var t=[];e.map(function(e){Z.seafileAPI.getFileInfo(e.repo_id,e.path).then(function(a){var o=new m.default(a.data);o.repo_name=e.repo_name,o.related_id=e.related_id,o.link=h.siteRoot+"lib/"+e.repo_id+"/file"+Y.Utils.encodePath(e.path),t.push(o),n.setState({direntList:t})})})},n.state={direntList:[]},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.getDirentList(this.props.relatedFiles)}},{key:"componentWillReceiveProps",value:function(e){e.relatedFiles.length!==this.props.relatedFiles.length&&this.getDirentList(e.relatedFiles)}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(f.ModalHeader,{toggle:this.toggle},(0,h.gettext)("Related Files")),u.default.createElement(f.ModalBody,{className:this.state.direntList.length>0?"list-related-file-body":""},u.default.createElement(f.Table,{hover:!0,size:"sm",className:"list-related-file-table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"40%"},(0,h.gettext)("Name")),u.default.createElement("th",{width:"20%"},(0,h.gettext)("Library Name")),u.default.createElement("th",{width:"13%"},(0,h.gettext)("Size")),u.default.createElement("th",{width:"20%"},(0,h.gettext)("Last Update")),u.default.createElement("th",{width:"5%"}),u.default.createElement("th",{width:"2%"}))),u.default.createElement("tbody",null,this.state.direntList.map(function(t,n){return u.default.createElement(u.default.Fragment,{key:n},u.default.createElement(g,{relatedFile:t,onDeleteRelatedFile:e.onDeleteRelatedFile}))}))),u.default.createElement("a",{href:"#",className:"add-related-file-link",onClick:this.props.addRelatedFileToggle},(0,h.gettext)("Add File"))),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,h.gettext)("Close"))))}}]),t}(u.default.Component);L.propTypes=S;var C={relatedFile:d.default.object,onDeleteRelatedFile:d.default.func.isRequired},g=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3",t=this.props.relatedFile;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("a",{href:t.link,target:"_blank"},t.name)),u.default.createElement("td",null,t.repo_name),u.default.createElement("td",null,t.size),u.default.createElement("td",null,t.mtime_relative),u.default.createElement("td",null,u.default.createElement("i",{className:e,onClick:this.props.onDeleteRelatedFile.bind(this,t)})),u.default.createElement("td",null))}}]),t}(u.default.Component);g.propTypes=C,t.default=L},161:function(e,t){},17:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(9),d=n(1),f=a(d),p=n(36),m=a(p),h=n(18),Y=a(h),Z={deceleration:"cubic-bezier(0.0, 0.0, 0.2, 1)",acceleration:"cubic-bezier(0.4, 0.0, 1, 1)",spring:"cubic-bezier(0.175, 0.885, 0.320, 1.175)"},S=c.css.keyframes("openAnimation",{from:{opacity:0,transform:"translateY(-120%)"},to:{transform:"translateY(0)"}}),L=c.css.keyframes("closeAnimation",{from:{transform:"scale(1)",opacity:1},to:{transform:"scale(0.9)",opacity:0}}),C=(0,c.css)({display:"flex",flexDirection:"column",alignItems:"center",height:0,transition:"all 240ms "+Z.deceleration,'&[data-state="entering"], &[data-state="entered"]':{animation:S+" 240ms "+Z.spring+" both"},'&[data-state="exiting"]':{animation:L+" 120ms "+Z.acceleration+" both"}}),g=function(e){function t(){var e,n,a,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.state={isShown:!0,height:0},a.close=function(){a.clearCloseTimer(),a.setState({isShown:!1})},a.startCloseTimer=function(){a.props.duration&&(a.closeTimer=setTimeout(function(){a.close()},1e3*a.props.duration))},a.clearCloseTimer=function(){a.closeTimer&&(clearTimeout(a.closeTimer),a.closeTimer=null)},a.handleMouseEnter=function(){a.clearCloseTimer()},a.handleMouseLeave=function(){a.startCloseTimer()},a.onRef=function(e){if(null!==e){var t=e.getBoundingClientRect(),n=t.height;a.setState({height:n})}},i=n,r(a,i)}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(e){e.isShown!==this.props.isShown&&this.setState({isShown:this.props.isShown})}},{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"render",value:function(){var e=this;return u.default.createElement(m.default,{appear:!0,unmountOnExit:!0,timeout:240,in:this.state.isShown,onExited:this.props.onRemove},function(t){return u.default.createElement("div",{"data-state":t,className:C,onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,style:{height:e.state.height,zIndex:e.props.zIndex,marginBottom:e.state.isShown?0:-e.state.height}},u.default.createElement("div",{ref:e.onRef,style:{padding:8}},u.default.createElement(Y.default,{intent:e.props.intent,title:e.props.title,children:e.props.children,isRemoveable:e.props.hasCloseButton,onRemove:function(){return e.close()}})))})}}]),t}(u.default.PureComponent);g.propTypes={zIndex:f.default.number,duration:f.default.number,onRemove:f.default.func,intent:f.default.oneOf(["none","success","warning","danger"]).isRequired,title:f.default.node,children:f.default.node,hasCloseButton:f.default.bool,isShown:f.default.bool},g.defaultProps={intent:"none"},t.default=g},18:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(9),d=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.containerStyle=(0,c.css)({borderRadius:"3px",backgroundColor:"#fff",padding:"10px 16px",display:"flex",boxSizing:"border-box",boxShadow:"rgba(67, 90, 111, 0.3) 0px 0px 1px, rgba(67, 90, 111, 0.47) 0px 8px 10px -4px",justifyContent:"space-between",flexDirection:"row"}),n.containerBorderSuccess=(0,c.css)({borderLeft:"3px solid rgb(71, 184, 129)"}),n.containerBorderWarn=(0,c.css)({borderLeft:"3px solid rgb(217, 130, 43)"}),n.containerBorderDanger=(0,c.css)({borderLeft:"3px solid rgb(236, 76, 71)"}),n.containerBorderNotify=(0,c.css)({borderLeft:"3px solid rgb(16, 112, 202)"}),n.toastTextTitle=(0,c.css)({fontWeight:"600",fontSize:"14px",color:"#435a6f",margin:"0"}),n.toastTextChild=(0,c.css)({fontSize:"14px",color:"#999",margin:"0"}),n.toastClose=(0,c.css)({marginLeft:"15px",height:"24px",width:"24px",lineHeight:"22px",fontWeight:"700",textAlign:"center",fontSize:"20px",color:"#000",cursor:"pointer",opacity:"0.5",":hover":{opacity:1}}),n.toastIcon=(0,c.css)({marginRight:"10px",width:"14px",height:"20px",lineHeight:"20px"}),n}return r(t,e),s(t,[{key:"getContainerStyle",value:function(e){switch(e){case"success":return{borderStyle:this.containerBorderSuccess,iconColor:(0,c.css)({color:"rgb(71, 184, 129)"}),iconClass:"fa fa-check-circle"};case"warning":return{borderStyle:this.containerBorderWarn,iconColor:(0,c.css)({color:"rgb(217, 130, 43)"}),iconClass:"fa fa-exclamation-triangle"};case"none":return{borderStyle:this.containerBorderNotify,iconColor:(0,c.css)({color:"rgb(16, 112, 202)"}),iconClass:"fa fa-exclamation-circle"};case"danger":return{borderStyle:this.containerBorderDanger,iconColor:(0,c.css)({color:"rgb(236, 76, 71)"}),iconClass:"fa fa-exclamation-circle"}}}},{key:"render",value:function(){var e=this.getContainerStyle(this.props.intent);return u.default.createElement("div",(0,c.css)(e.borderStyle,this.containerStyle),u.default.createElement("div",{className:this.toastIcon},u.default.createElement("i",i({className:e.iconClass},e.iconColor))),u.default.createElement("div",{className:this.toastTextContainer},u.default.createElement("p",{className:this.toastTextTitle},this.props.title),this.props.children?u.default.createElement("p",{className:this.toastTextChild},this.props.children):null),u.default.createElement("div",{onClick:this.props.onRemove,className:this.toastClose},u.default.createElement("span",null,"\xd7")))}}]),t}(u.default.PureComponent);t.default=d},19:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(4),p=n(32),m=a(p),h={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,permissions:d.default.array.isRequired,currentPermission:d.default.string.isRequired,onPermissionChanged:d.default.func.isRequired},Y=function(e){function t(){var e,n,a,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.translatePermission=function(e){return f.Utils.sharePerms(e)},a.translateExplanation=function(e){return f.Utils.sharePermsExplanation(e)},i=n,r(a,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(m.default,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.permissions,currentOption:this.props.currentPermission,onOptionChanged:this.props.onPermissionChanged,translateOption:this.translatePermission,translateExplanation:this.translateExplanation})}}]),t}(u.default.Component);Y.propTypes=h,t.default=Y},194:function(e,t){},2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dirPath="/",t.gettext=window.gettext,t.siteRoot=window.app.config.siteRoot,t.loginUrl=window.app.config.loginUrl,t.avatarInfo=window.app.config.avatarInfo,t.logoPath=window.app.config.logoPath,t.mediaUrl=window.app.config.mediaUrl,t.siteTitle=window.app.config.siteTitle,t.siteName=window.app.config.siteName,t.logoWidth=window.app.config.logoWidth,t.logoHeight=window.app.config.logoHeight,t.isPro="True"===window.app.config.isPro,t.isDocs="True"===window.app.config.isDocs,t.lang=window.app.config.lang,t.fileServerRoot=window.app.config.fileServerRoot,t.seafileVersion=window.app.config.seafileVersion,t.serviceURL=window.app.config.serviceURL,t.seafileCollabServer=window.app.pageOptions.seafileCollabServer,t.name=window.app.pageOptions.name,t.contactEmail=window.app.pageOptions.contactEmail,t.username=window.app.pageOptions.username,t.canAddRepo=window.app.pageOptions.canAddRepo,t.canGenerateShareLink=window.app.pageOptions.canGenerateShareLink,t.canGenerateUploadLink=!!window.app.pageOptions.canGenerateUploadLink,t.canViewOrg="True"===window.app.pageOptions.canViewOrg,t.fileAuditEnabled=!!window.app.pageOptions.fileAuditEnabled,t.enableFileComment=!!window.app.pageOptions.enableFileComment,t.folderPermEnabled="True"===window.app.pageOptions.folderPermEnabled,t.enableResetEncryptedRepoPassword="True"===window.app.pageOptions.enableResetEncryptedRepoPassword,t.isEmailConfigured="True"===window.app.pageOptions.isEmailConfigured,t.enableUploadFolder="True"===window.app.pageOptions.enableUploadFolder,t.enableResumableFileUpload="True"===window.app.pageOptions.enableResumableFileUpload,t.storages=window.app.pageOptions.storages,t.enableRepoSnapshotLabel=window.app.pageOptions.enableRepoSnapshotLabel,t.shareLinkExpireDaysMin=window.app.pageOptions.shareLinkExpireDaysMin,t.shareLinkExpireDaysMax=window.app.pageOptions.shareLinkExpireDaysMax,t.maxFileName=window.app.pageOptions.maxFileName,t.enableWiki=window.app.pageOptions.enableWiki,t.enableEncryptedLibrary=window.app.pageOptions.enableEncryptedLibrary,t.enableRepoHistorySetting=window.app.pageOptions.enableRepoHistorySetting,t.isSystemStaff=window.app.pageOptions.isSystemStaff,t.thumbnailSizeForOriginal=window.app.pageOptions.thumbnailSizeForOriginal,t.repoPasswordMinLength=window.app.pageOptions.repoPasswordMinLength,t.curNoteMsg=window.app.pageOptions.curNoteMsg,t.curNoteID=window.app.pageOptions.curNoteID,t.slug=window.wiki?window.wiki.config.slug:"",t.repoID=window.wiki?window.wiki.config.repoId:"",t.initialPath=window.wiki?window.wiki.config.initial_path:"",t.permission=window.wiki?"True"===window.wiki.config.permission:"",t.isDir=window.wiki?window.wiki.config.isDir:"",t.serviceUrl=window.wiki?window.wiki.config.serviceUrl:"",t.isPublicWiki=window.wiki?"True"===window.wiki.config.isPublicWiki:"",t.PER_PAGE=25,t.historyRepoID=window.fileHistory?window.fileHistory.pageOptions.repoID:"",t.repoName=window.fileHistory?window.fileHistory.pageOptions.repoName:"",t.filePath=window.fileHistory?window.fileHistory.pageOptions.filePath:"",t.fileName=window.fileHistory?window.fileHistory.pageOptions.fileName:"",t.draftFilePath=window.draft?window.draft.config.draftFilePath:"",t.draftOriginFilePath=window.draft?window.draft.config.draftOriginFilePath:"",t.draftFileName=window.draft?window.draft.config.draftFileName:"",t.draftID=window.draft?window.draft.config.draftID:"",t.draftRepoID=window.draft?window.draft.config.draftRepoID:"",t.author=window.draft?window.draft.config.author:"",t.authorAvatar=window.draft?window.draft.config.authorAvatar:"",t.originFileExists=window.draft?window.draft.config.originFileExists:"",t.draftFileExists=window.draft?window.draft.config.draftFileExists:"",t.draftStatus=window.draft?window.draft.config.draftStatus:"",t.draftPublishVersion=window.draft?window.draft.config.draftPublishVersion:"",t.originFileVersion=window.draft?window.draft.config.originFileVersion:"",t.orgID=window.org?window.org.pageOptions.orgID:"",t.invitationLink=window.org?window.org.pageOptions.invitationLink:"",t.orgMemberQuotaEnabled=window.org?window.org.pageOptions.orgMemberQuotaEnabled:"",t.constanceEnabled=window.sysadmin?window.sysadmin.pageOptions.constance_enabled:"",t.multiTenancy=window.sysadmin?window.sysadmin.pageOptions.multi_tenancy:"",t.multiInstitution=window.sysadmin?window.sysadmin.pageOptions.multi_institution:"",t.sysadminExtraEnabled=window.sysadmin?window.sysadmin.pageOptions.sysadmin_extra_enabled:"",t.enableGuestInvitation=window.sysadmin?window.sysadmin.pageOptions.enable_guest_invitation:"",t.enableTermsAndConditions=window.sysadmin?window.sysadmin.pageOptions.enable_terms_and_conditions:"",t.isDefaultAdmin=window.sysadmin?window.sysadmin.pageOptions.is_default_admin:"",t.enableFileScan=window.sysadmin?window.sysadmin.pageOptions.enable_file_scan:"",t.canViewSystemInfo=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_system_info:"",t.canViewStatistic=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_statistic:"",t.canConfigSystem=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_config_system:"",t.canManageLibrary=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_library:"",t.canManageUser=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_user:"",t.canManageGroup=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_group:"",t.canViewUserLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_user_log:"",t.canViewAdminLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_admin_log:""},23:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=n(0),c=a(u),d=n(1),f=a(d),p=n(76),m=a(p),h=n(3),Y=n(2),Z={placeholder:f.default.string.isRequired,onSelectChange:f.default.func.isRequired,isMulti:f.default.bool.isRequired,className:f.default.string},S=function(e){return c.default.createElement("div",l({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,Y.gettext)("User not found"))},L=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.options=[],n.props.onSelectChange(e)},n.loadOptions=function(e,t){var a=e.trim();a.length>0&&h.seafileAPI.searchUsers(a).then(function(e){n.options=[];for(var a=0;a<e.data.users.length;a++){var o=e.data.users[a],r={};r.value=o.name,r.email=o.email,r.label=c.default.createElement(c.default.Fragment,null,c.default.createElement("img",{src:o.avatar_url,className:"select-module select-module-icon avatar",alt:""}),c.default.createElement("span",{className:"select-module select-module-name"},o.name)),n.options.push(r)}t(n.options)})},n.clearSelect=function(){n.refs.userSelect.select.onChange([],{action:"clear"})},n.options=[],n}return i(t,e),s(t,[{key:"render",value:function(){return c.default.createElement(m.default,{isClearable:!0,classNamePrefix:!0,components:{NoOptionsMessage:S},isMulti:this.props.isMulti,loadOptions:this.loadOptions,onChange:this.handleSelectChange,placeholder:this.props.placeholder,className:"user-select "+this.props.className,ref:"userSelect"})}}]),t}(c.default.Component);L.propTypes=Z,t.default=L},24:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function e(t){a(this,e),this.id=t.file_tag_id,this.repo_tag_id=t.repo_tag_id,this.name=t.tag_name,this.color=t.tag_color};t.default=o},25:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(5),p=n(2),m=n(49),h=a(m),Y=n(50),Z=a(Y),S=n(51),L=a(S),C=n(52),g=a(C);n(53);var X={isGroupOwnedRepo:d.default.bool,itemType:d.default.string.isRequired,itemName:d.default.string.isRequired,itemPath:d.default.string.isRequired,toggleDialog:d.default.func.isRequired,repoID:d.default.string.isRequired,repoEncrypted:d.default.bool,userPerm:d.default.string,enableDirPrivateShare:d.default.bool},J=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getInitialActiveTab=function(){var e=n.props,t=e.repoEncrypted,a=e.userPerm,o=e.enableDirPrivateShare,r=!t&&p.canGenerateShareLink,i=!t&&p.canGenerateUploadLink&&"rw"==a;return r?"shareLink":i?"uploadLink":o?"shareToUser":void 0},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderDirContent=function(){var e=n.state.activeTab,t=n.props,a=t.repoEncrypted,o=t.userPerm,r=t.enableDirPrivateShare,i=!a&&p.canGenerateShareLink,s=!a&&p.canGenerateUploadLink&&"rw"==o;return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"share-dialog-side"},u.default.createElement(f.Nav,{pills:!0,vertical:!0},i&&u.default.createElement(f.NavItem,null,u.default.createElement(f.NavLink,{className:"shareLink"===e?"active":"",onClick:n.toggle.bind(n,"shareLink")},(0,p.gettext)("Share Link"))),s&&u.default.createElement(f.NavItem,null,u.default.createElement(f.NavLink,{className:"uploadLink"===e?"active":"",onClick:n.toggle.bind(n,"uploadLink")},(0,p.gettext)("Upload Link"))),r&&u.default.createElement(l.Fragment,null,u.default.createElement(f.NavItem,null,u.default.createElement(f.NavLink,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser")},(0,p.gettext)("Share to user"))),u.default.createElement(f.NavItem,null,u.default.createElement(f.NavLink,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup")},(0,p.gettext)("Share to group")))))),u.default.createElement("div",{className:"share-dialog-main"},u.default.createElement(f.TabContent,{activeTab:n.state.activeTab},i&&u.default.createElement(f.TabPane,{tabId:"shareLink"},u.default.createElement(L.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})),s&&u.default.createElement(f.TabPane,{tabId:"uploadLink"},u.default.createElement(g.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})),r&&u.default.createElement(l.Fragment,null,u.default.createElement(f.TabPane,{tabId:"shareToUser"},u.default.createElement(h.default,{itemType:n.props.itemType,isGroupOwnedRepo:n.props.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID})),u.default.createElement(f.TabPane,{tabId:"shareToGroup"},u.default.createElement(Z.default,{itemType:n.props.itemType,isGroupOwnedRepo:n.props.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID}))))))},n.renderFileContent=function(){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"share-dialog-side"},u.default.createElement(f.Nav,{pills:!0,vertical:!0},u.default.createElement(f.NavItem,null,u.default.createElement(f.NavLink,{className:"active",onClick:function(){n.toggle.bind(n,"shareLink")}},(0,p.gettext)("Share Link"))))),u.default.createElement("div",{className:"share-dialog-main"},u.default.createElement(f.TabContent,{activeTab:n.state.activeTab},u.default.createElement(f.TabPane,{tabId:"shareLink"},u.default.createElement(L.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})))))},n.state={activeTab:n.getInitialActiveTab()},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.itemType,n=e.itemName,a=e.repoEncrypted,o=!a&&p.canGenerateShareLink;return u.default.createElement("div",null,u.default.createElement(f.Modal,{isOpen:!0,style:{maxWidth:"720px"},className:"share-dialog",toggle:this.props.toggleDialog},u.default.createElement(f.ModalHeader,{toggle:this.props.toggleDialog},(0,p.gettext)("Share")," ",u.default.createElement("span",{className:"op-target",title:n},n)),u.default.createElement(f.ModalBody,{className:"dialog-list-container share-dialog-content"},("library"===t||"dir"===t)&&this.renderDirContent(),"file"===t&&o&&this.renderFileContent())))}}]),t}(u.default.Component);J.propTypes=X,t.default=J},258:function(e,t){},268:function(e,t){},269:function(e,t){},271:function(e,t){},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.seafileAPI=void 0;var a=n(22),o=function(e){return e&&e.__esModule?e:{default:e}}(a),r=n(35),i=n(2),s=new r.SeafileAPI,l=o.default.load("sfcsrftoken");s.initForSeahubUsage({siteRoot:i.siteRoot,xcsrfHeaders:l}),t.seafileAPI=s},30:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(1),f=a(d),p=n(5),m=n(3),h=n(2),Y=n(4),Z=n(31),S=a(Z),L=n(42),C=a(L),g=n(11),X=a(g),J=n(46),D=a(J);n(48);var P={isShowFile:f.default.bool,repoID:f.default.string,onDirentItemClick:f.default.func,onRepoItemClick:f.default.func,mode:f.default.oneOf(["current_repo_and_other_repos","only_all_repos","only_current_library"])},w=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onOtherRepoToggle=function(){if(n.state.hasRequest)n.setState({isOtherRepoShow:!n.state.isOtherRepoShow});else{var e=n;m.seafileAPI.listRepos().then(function(t){for(var a=t.data.repos,o=[],r=[],i=0;i<a.length;i++)"rw"===a[i].permission&&(e.props.repoID&&a[i].repo_name===e.state.currentRepoInfo.repo_name||r.indexOf(a[i].repo_id)>-1||(o.push(a[i]),r.push(a[i].repo_id)));o=Y.Utils.sortRepos(o,"name","asc"),n.setState({repoList:o,isOtherRepoShow:!n.state.isOtherRepoShow})})}},n.onCurrentRepoToggle=function(){return[n.setState({isCurrentRepoShow:!n.state.isCurrentRepoShow})]},n.onDirentItemClick=function(e,t,a){n.props.onDirentItemClick(e,t,a),n.setState({selectedRepo:e,selectedPath:t})},n.onRepoItemClick=function(e){n.props.onRepoItemClick&&n.props.onRepoItemClick(e),n.setState({selectedRepo:e,selectedPath:""})},n.onCloseSearching=function(){n.setState({isSearching:!1,isResultGot:!1,searchInfo:"",searchResults:[]}),n.inputValue="",n.timer=null,n.source=null},n.onSearchInfoChanged=function(e){var t=e.target.value.trim();if(n.setState({searchInfo:t}),n.inputValue===t)return!1;if(n.inputValue=t,0===t.length)return n.setState({isSearching:!1,searchResults:[]}),!1;if(!n.state.searchResults.length&&t.length>0&&n.setState({isSearching:!0,isResultGot:!1}),""===n.inputValue||n.getValueLength(n.inputValue)<3)return n.setState({isResultGot:!1}),!1;var a=n.props.repoID,o=n.props.isShowFile,r=n.props.mode,i="only_current_library"===r?a:"all",s={q:t,search_repo:i,search_ftypes:"all",obj_type:o?"file":"dir"};n.timer&&clearTimeout(n.timer),n.timer=setTimeout(n.getSearchResult(s),500)},n.getSearchResult=function(e){n.source&&n.cancelRequest(),n.setState({isResultGot:!1}),n.source=m.seafileAPI.getSource(),n.sendRequest(e,n.source.token)},n.sendRequest=function(e,t){m.seafileAPI.searchFiles(e,t).then(function(e){if(!e.data.total)return n.setState({searchResults:[],isResultGot:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({searchResults:t,isResultGot:!0}),n.source=null}).catch(function(e){console.log(e)})},n.cancelRequest=function(){n.source.cancel("prev request is cancelled")},n.getValueLength=function(e){for(var t,n=0,a=0;n<e.length;n++)t=e.charCodeAt(n),10==t?a+=2:t<127?a+=1:t>=128&&t<=2047?a+=2:t>=2048&&t<=65535&&(a+=3);return a},n.formatResultItems=function(e){for(var t=[],n=e.length>10?10:e.length,a=0;a<n;a++)t[a]={},t[a].index=[a],t[a].name=e[a].name,t[a].path=e[a].fullpath,t[a].repo_id=e[a].repo_id,t[a].repo_name=e[a].repo_name,t[a].is_dir=e[a].is_dir,t[a].link_content=decodeURI(e[a].fullpath).substring(1),t[a].content=e[a].content_highlight;return t},n.onSearchedItemClick=function(e){e.type=e.is_dir?"dir":"file";var t=new S.default(e);n.props.onDirentItemClick(t,e.path,e)},n.renderSearchedView=function(){return n.getValueLength(n.inputValue)<3?"":n.state.isResultGot?n.state.isResultGot&&0===n.state.searchResults.length?c.default.createElement("div",{className:"search-result-none text-center"},(0,h.gettext)("No results matching.")):n.state.isResultGot&&n.state.searchResults.length>0?c.default.createElement(D.default,{searchResults:n.state.searchResults,onItemClick:n.onSearchedItemClick}):void 0:c.default.createElement(X.default,null)},n.renderRepoListView=function(){return c.default.createElement("div",{className:"file-chooser-container"},"current_repo_and_other_repos"===n.props.mode&&c.default.createElement(u.Fragment,null,c.default.createElement("div",{className:"list-view"},c.default.createElement("div",{className:"list-view-header"},c.default.createElement("span",{className:"item-toggle fa "+(n.state.isCurrentRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onCurrentRepoToggle}),c.default.createElement("span",{className:"library"},(0,h.gettext)("Current Library"))),n.state.isCurrentRepoShow&&n.state.currentRepoInfo&&c.default.createElement(C.default,{initToShowChildren:!0,currentRepoInfo:n.state.currentRepoInfo,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile})),c.default.createElement("div",{className:"list-view"},c.default.createElement("div",{className:"list-view-header"},c.default.createElement("span",{className:"item-toggle fa "+(n.state.isOtherRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onOtherRepoToggle}),c.default.createElement("span",{className:"library"},(0,h.gettext)("Other Libraries"))),n.state.isOtherRepoShow&&c.default.createElement(C.default,{initToShowChildren:!1,repoList:n.state.repoList,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile}))),"only_current_library"===n.props.mode&&c.default.createElement("div",{className:"list-view"},c.default.createElement("div",{className:"list-view-header"},c.default.createElement("span",{className:"item-toggle fa "+(n.state.isCurrentRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onCurrentRepoToggle}),c.default.createElement("span",{className:"library"},(0,h.gettext)("Current Library"))),n.state.isCurrentRepoShow&&n.state.currentRepoInfo&&c.default.createElement(C.default,{initToShowChildren:!0,currentRepoInfo:n.state.currentRepoInfo,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile})),"only_all_repos"===n.props.mode&&c.default.createElement("div",{className:"file-chooser-container"},c.default.createElement("div",{className:"list-view"},c.default.createElement("div",{className:"list-view-header"},c.default.createElement("span",{className:"item-toggle fa fa-caret-down"}),c.default.createElement("span",{className:"library"},(0,h.gettext)("Libraries"))),c.default.createElement(C.default,{initToShowChildren:!1,repoList:n.state.repoList,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile}))))},n.state={hasRequest:!1,isCurrentRepoShow:!0,isOtherRepoShow:!1,repoList:[],currentRepoInfo:null,selectedRepo:null,selectedPath:"",isSearching:!1,isResultGot:!1,searchInfo:"",searchResults:[]},n.inputValue="",n.timer=null,n.source=null,n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.repoID){var t=this.props.repoID;m.seafileAPI.getRepoInfo(t).then(function(t){var n=new S.default(t.data);e.setState({currentRepoInfo:n,selectedRepo:n}),e.props.onRepoItemClick(n)})}else m.seafileAPI.listRepos().then(function(t){for(var n=t.data.repos,a=[],o=[],r=0;r<n.length;r++)"rw"===n[r].permission&&(o.indexOf(n[r].repo_id)>-1||(a.push(n[r]),o.push(n[r].repo_id)));a=Y.Utils.sortRepos(a,"name","asc"),e.setState({repoList:a})})}},{key:"render",value:function(){var e;return!this.state.selectedRepo&&this.props.repoID?"":c.default.createElement(u.Fragment,null,h.isPro&&c.default.createElement("div",{className:"file-chooser-search-input"},c.default.createElement(p.Input,(e={className:"search-input",placeholder:(0,h.gettext)("Search...")},o(e,"className","mb-2"),o(e,"type","text"),o(e,"value",this.state.searchInfo),o(e,"onChange",this.onSearchInfoChanged),e)),0!==this.state.searchInfo.length&&c.default.createElement("span",{className:"search-control attr-action-icon fas fa-times",onClick:this.onCloseSearching})),this.state.isSearching&&c.default.createElement("div",{className:"file-chooser-search-container"},this.renderSearchedView()),!this.state.isSearching&&this.renderRepoListView())}}]),t}(c.default.Component);w.propTypes=P,t.default=w},31:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=function e(t){a(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.permission=t.permission,this.size=o.Utils.bytesToSize(t.size),this.file_count=t.file_count,this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.is_admin=t.is_admin,this.is_virtual=t.is_virtual,this.no_quota=t.no_quota,this.has_been_shared_out=t.has_been_shared_out,this.encrypted=t.encrypted,this.lib_need_decrypt=t.lib_need_decrypt};t.default=r},32:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(2),p=n(37),m=a(p);n(38);var h={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,options:d.default.array.isRequired,currentOption:d.default.string.isRequired,translateOption:d.default.func.isRequired,translateExplanation:d.default.func,onOptionChanged:d.default.func.isRequired,toggleItemFreezed:d.default.func},Y=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOptions=function(){n.options=[];for(var e=n.props.options,t=0,a=e.length;t<a;t++){var o={};o.value=e[t],o.label=u.default.createElement("div",null,n.props.translateOption(e[t]),n.props.translateExplanation&&u.default.createElement("div",{className:"permission-editor-explanation"},n.props.translateExplanation(e[t]))),n.options.push(o)}},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isEditing:!0}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!0)},n.onOptionChanged=function(e){var t=e.value;t!==n.props.currentOption&&n.props.onOptionChanged(t),n.setState({isEditing:!1}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!1)},n.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},n.onHideSelect=function(){n.setState({isEditing:!1}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!1)},n.state={isEditing:!1},n.options=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect),this.setOptions()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentOption,n=e.isTextMode;return u.default.createElement("div",{className:"permission-editor",onClick:this.onSelectHandler},(!n||this.state.isEditing)&&u.default.createElement(m.default,{options:this.options,className:"permission-editor-select",classNamePrefix:"permission-editor",placeholder:this.props.translateOption(t),onChange:this.onOptionChanged,captureMenuScroll:!1}),n&&!this.state.isEditing&&u.default.createElement("div",null,this.props.translateOption(t),this.props.isEditIconShow&&u.default.createElement("span",{title:(0,f.gettext)("Edit"),className:"fa fa-pencil-alt attr-action-icon",onClick:this.onEditPermission})))}}]),t}(u.default.Component);Y.propTypes=h,t.default=Y},38:function(e,t){},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;var a=n(2),o=n(13),r=t.Utils={keyCodes:{esc:27,space:32,tab:9,up:38,down:40},bytesToSize:function(e){if("undefined"==typeof e)return" ";if(e<0)return"--";var t=["bytes","KB","MB","GB","TB","PB"];if(0===e)return e+" "+t[0];var n=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===n?e+" "+t[n]:(e/Math.pow(1e3,n)).toFixed(1)+" "+t[n]},isHiDPI:function(){return(window.devicePixelRatio?window.devicePixelRatio:1)>1},FILEEXT_ICON_MAP:{md:"txt.png",txt:"txt.png",pdf:"pdf.png",doc:"word.png",docx:"word.png",odt:"word.png",fodt:"word.png",ppt:"ppt.png",pptx:"ppt.png",odp:"ppt.png",fodp:"ppt.png",xls:"excel.png",xlsx:"excel.png",ods:"excel.png",fods:"excel.png",mp4:"video.png",ogv:"video.png",webm:"video.png",mov:"video.png",flv:"video.png",wmv:"video.png",rmvb:"video.png",mp3:"music.png",oga:"music.png",ogg:"music.png",flac:"music.png",aac:"music.png",ac3:"music.png",wma:"music.png",jpg:"pic.png",jpeg:"pic.png",png:"pic.png",svg:"pic.png",gif:"pic.png",bmp:"pic.png",ico:"pic.png",default:"file.png"},imageCheck:function(e){return-1!=e.lastIndexOf(".")&&-1!=["gif","jpeg","jpg","png","ico","bmp"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},videoCheck:function(e){return-1!=e.lastIndexOf(".")&&-1!=["mp4","ogv","webm","mov"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},encodePath:function(e){if(!e)return"";for(var t=e.split("/"),n=[],a=0,o=t.length;a<o;a++)n.push(encodeURIComponent(t[a]));return n.join("/")},HTMLescape:function(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML},generateDialogTitle:function(e,t){var n=this.HTMLescape(t),a='<span class="op-target ellipsis ellipsis-op-target" title='+n+">"+n+"</span>";return e.replace("{placeholder}",a)},getFileName:function(e){var t=e.lastIndexOf("/");return e.slice(t+1)},getPaths:function(e){for(var t=e.split("/").slice(1),n=[];t.length;)n.push("/"+t.join("/")),t.pop();return n.reverse()},getFolderName:function(e){return"/"===e?e:(e="/"!==e[e.length-1]?e:e.slice(0,e.length-2),e.slice(e.lastIndexOf("/")+1))},getDirName:function(e){var t=e.slice(0,e.lastIndexOf("/"));return""===t?"/":t},isChildPath:function(e,t){return this.getDirName(e)===t},isAncestorPath:function(e,t){return t.indexOf(e)>-1},renameAncestorPath:function(e,t,n){return e.replace(t,n)},joinPath:function(e,t){return"/"===e[e.length-1]?e+t:e+"/"+t},isSupportUploadFolder:function(){return-1!=navigator.userAgent.indexOf("Firefox")||navigator.userAgent.indexOf("Chrome")>-1},getDefaultLibIconUrl:function(e){var t=r.isHiDPI()?48:24;t=e?256:t;return a.mediaUrl+"img/lib/"+t+"/lib.png"},getLibIconUrl:function(e,t){var n=e.permission||e.share_permission,o=r.isHiDPI()?48:24;o=t?256:o;var i="lib.png";return e.encrypted&&(i="lib-encrypted.png"),"r"!==n&&"perview"!==n||(i="lib-readonly.png"),a.mediaUrl+"img/lib/"+o+"/"+i},getDirentIcon:function(e,t){var n=this.isHiDPI()?48:24;if(n=t?192:n,e.isDir()){var a=!1;return!e.permission||"r"!==e.permission&&"preview"!==e.permission||(a=!0),this.getFolderIconUrl(a,n)}return this.getFileIconUrl(e.name,n)},getFolderIconUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];return t||(t=r.isHiDPI()?48:24),t=t>24?192:24,a.mediaUrl+"img/folder"+(e?"-read-only-":"-")+t+".png"},getFileIconUrl:function(e,t){t||(t=r.isHiDPI()?48:24),t=t>24?192:24;var n="";return-1==e.lastIndexOf(".")?a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP.default:(n=e.substr(e.lastIndexOf(".")+1).toLowerCase(),this.FILEEXT_ICON_MAP[n]?a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP[n]:a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP.default)},getLibIconTitle:function(e){var t,n=e.permission||e.share_permission;if(e.encrypted)t=(0,a.gettext)("Encrypted library");else if(e.is_admin)t=(0,a.gettext)("Admin access");else switch(n){case"rw":t=(0,a.gettext)("Read-Write library");break;case"r":t=(0,a.gettext)("Read-Only library");break;case"cloud-edit":t=(0,a.gettext)("Preview-Edit-on-Cloud library");break;case"preview":t=(0,a.gettext)("Preview-on-Cloud library")}return t},getFolderIconTitle:function(e){var t;switch(e.permission){case"rw":t=(0,a.gettext)("Read-Write folder");break;case"r":t=(0,a.gettext)("Read-Only folder");break;case"cloud-edit":t=(0,a.gettext)("Preview-Edit-on-Cloud folder");break;case"preview":t=(0,a.gettext)("Preview-on-Cloud folder")}return t},sharePerms:function(e){var t;switch(e){case"rw":t=(0,a.gettext)("Read-Write");break;case"r":t=(0,a.gettext)("Read-Only");break;case"admin":t=(0,a.gettext)("Admin");break;case"cloud-edit":t=(0,a.gettext)("Preview-Edit-on-Cloud");break;case"preview":t=(0,a.gettext)("Preview-on-Cloud")}return t},sharePermsExplanation:function(e){var t;switch(e){case"rw":t=(0,a.gettext)("User can read, write, upload, download and sync files.");break;case"r":t=(0,a.gettext)("User can read, download and sync files.");break;case"admin":t=(0,a.gettext)("Besides Write permission, user can also share the library.");break;case"cloud-edit":t=(0,a.gettext)("Same as Preview on cloud. But user can also edit files online via browser.");break;case"preview":t=(0,a.gettext)("User can only view files online via browser. Files can't be downloaded.")}return t},formatSize:function(e){var t=e.bytes,n=e.precision||0;return t>=0&&t<1e3?t+" B":t>=1e3&&t<1e6?(t/1e3).toFixed(n)+" KB":t>=1e6&&t<1e9?(t/1e6).toFixed(n)+" MB":t>=1e9&&t<1e12?(t/1e9).toFixed(n)+" GB":t>=1e12?(t/1e12).toFixed(n)+" TB":t+" B"},formatBitRate:function(e){var t;return"number"!==typeof e?"":(t=e/8,t>=1e9?(t/1e9).toFixed(2)+" GB/s":t>=1e6?(t/1e6).toFixed(2)+" MB/s":t>=1e3?(t/1e3).toFixed(2)+" kB/s":t.toFixed(2)+" B/s")},isMarkdownFile:function(e){var t=e.lastIndexOf(".");if(-1===t)return!1;var n=e.substring(t).toLowerCase();return".md"===n||".markdown"===n},isInternalMarkdownLink:function(e,t){return new RegExp(a.serviceURL+"/lib/"+t+".*.md$").test(e)},isInternalDirLink:function(e,t){return new RegExp(a.serviceURL+"/library/"+t+".*").test(e)},getPathFromInternalMarkdownLink:function(e,t){var n=new RegExp(a.serviceURL+"/lib/"+t+"/file(.*.md)"),o=n.exec(e);return decodeURIComponent(o[1])},getPathFromInternalDirLink:function(e,t){var n=new RegExp(a.serviceURL+"/library/"+t+"(/.*)"),o=n.exec(e),r=decodeURIComponent(o[1]);return r=r.slice(1),r=r.slice(r.indexOf("/"))},isWikiInternalMarkdownLink:function(e,t){return t=encodeURIComponent(t),new RegExp(a.serviceURL+"/wikis/"+t+".*.md$").test(e)},isWikiInternalDirLink:function(e,t){return t=encodeURIComponent(t),new RegExp(a.serviceURL+"/wikis/"+t+".*").test(e)},getPathFromWikiInternalMarkdownLink:function(e,t){t=encodeURIComponent(t);var n=new RegExp(a.serviceURL+"/wikis/"+t+"(.*.md)"),o=n.exec(e),r=o[1];try{r=decodeURIComponent(r)}catch(e){r=r.replace(/%/g,"%25"),r=decodeURIComponent(r)}return r},getPathFromWikiInternalDirLink:function(e,t){t=encodeURIComponent(t);var n=new RegExp(a.serviceURL+"/wikis/"+t+"(/.*)"),o=n.exec(e),r=o[1];try{r=decodeURIComponent(r)}catch(e){r=r.replace(/%/g,"%25"),r=decodeURIComponent(r)}return r},compareTwoWord:function(e,t){var n,a,r=e.charCodeAt(0),i=t.charCodeAt(0);return 19968<r&&r<40869&&19968<i&&i<40869?(n=o.strChineseFirstPY.charAt(r-19968).toLowerCase(),a=o.strChineseFirstPY.charAt(i-19968).toLowerCase(),n>=a?1:-1):19968<r&&r<40869&&!(19968<i&&i<40869)?1:!(19968<r&&r<40869)&&19968<i&&i<40869?-1:(n=e.toLowerCase(),a=t.toLowerCase(),this.compareStrWithNumbersIn(n,a))},compareStrWithNumbersIn:function(e,t){var n,a,o,r=/\d+|\D+/g,i=/\d/,s=e.match(r),l=t.match(r),u=Math.min(s.length,l.length);if(s&&l&&(n=i.test(s[0]))==i.test(l[0]))for(var c=0;c<u;c++){if(a=s[c],o=l[c],n&&(a=parseInt(a,10),o=parseInt(o,10)),a!=o)return a<o?-1:1;n=!n}return(e>=t)-(e<=t)},sortRepos:function(e,t,n){var a=this,o=void 0;switch(t+"-"+n){case"name-asc":o=function(e,t){return e.repo_name?t.repo_name?a.compareTwoWord(e.repo_name,t.repo_name):-1:1};break;case"name-desc":o=function(e,t){return e.repo_name?t.repo_name?-a.compareTwoWord(e.repo_name,t.repo_name):1:-1};break;case"time-asc":o=function(e,t){return e.last_modified<t.last_modified?-1:1};break;case"time-desc":o=function(e,t){return e.last_modified<t.last_modified?1:-1}}return e.sort(o),e},sortDirents:function(e,t,n){var a=this,o=void 0;switch(t+"-"+n){case"name-asc":o=function(e,t){return a.compareTwoWord(e.name,t.name)};break;case"name-desc":o=function(e,t){return-a.compareTwoWord(e.name,t.name)};break;case"time-asc":o=function(e,t){return e.mtime<t.mtime?-1:1};break;case"time-desc":o=function(e,t){return e.mtime<t.mtime?1:-1}}return e.sort(function(e,t){return"dir"==e.type&&"file"==t.type?-1:"file"==e.type&&"dir"==t.type?1:o(e,t)}),e},changeMarkdownNodes:function(e,t){return e.map(function(e){t(e),e.nodes&&e.nodes.length>0&&r.changeMarkdownNodes(e.nodes,t)}),e},chooseLanguage:function(e){var t=void 0;switch(e){case"py":t="python";break;case"js":t="javascript";break;case"c":t="text/x-csrc";break;case"cpp":t="text/x-c++src";break;case"java":t="text/x-java";break;case"cs":t="text/x-csharp";break;case"mdf":t="text/x-sql";break;case"html":t="htmlmixed";break;default:t=e}return t},DARK_COLOR_MAP:{red:"#D11507",orange:"#FF8C00",yellow:"#EDEF00",green:"#006400",cyan:"#00E0E1",blue:"#2510A3",indigo:"#350C56",purple:"#551054",pink:"#E3A5B0",azure:"#C4D0D0",lime:"#00E100",teal:"#006A6B",gray:"#545454","#FFA8A8":"#E49090","#FFA94D":"#E39136","#FFD43B":"#E0B815","#A0EC50":"#83CF32","#A9E34B":"#8DC72E","#63E6BE":"#43CAA4","#4FD2C9":"#2DB9B0","#72C3FC":"#57ABE3","#91A7FF":"#7A91E7","#E599F7":"#CC82DE","#B197FC":"#9B82E5","#F783AC":"#DF6D97","#CED4DA":"#A8ADB2"},getDarkColor:function(e){return this.DARK_COLOR_MAP[e]}}},40:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function e(t){a(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.path=t.path,this.obj_name=t.obj_name,this.is_dir=t.is_dir,this.permissions=t.permissions,this.username=t.username,this.is_expired=t.is_expired,this.expire_date=t.expire_date,this.token=t.token,this.link=t.link,this.view_cnt=t.view_cnt,this.ctime=t.ctime};t.default=o},41:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function e(t){a(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.path=t.path,this.link=t.link,this.obj_name=t.obj_name,this.username=t.username,this.ctime=t.ctime,this.token=t.token,this.view_cnt=t.view_cnt};t.default=o},42:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(43),p=a(f),m={currentRepoInfo:d.default.object,isShowFile:d.default.bool,repo:d.default.object,repoList:d.default.array,selectedRepo:d.default.object,initToShowChildren:d.default.bool.isRequired,selectedPath:d.default.string,onDirentItemClick:d.default.func.isRequired,onRepoItemClick:d.default.func.isRequired},h=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentRepoInfo,a=t.repoList;return n&&(a=[],a.push(n)),u.default.createElement("ul",{className:"list-view-content file-chooser-item"},a.length>0&&a.map(function(t,n){return u.default.createElement(p.default,{key:n,repo:t,initToShowChildren:e.props.initToShowChildren,selectedRepo:e.props.selectedRepo,selectedPath:e.props.selectedPath,onRepoItemClick:e.props.onRepoItemClick,onDirentItemClick:e.props.onDirentItemClick,isShowFile:e.props.isShowFile})}))}}]),t}(u.default.Component);h.propTypes=m,t.default=h},43:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(44),p=a(f),m={isShowFile:d.default.bool,selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,initToShowChildren:d.default.bool.isRequired,onDirentItemClick:d.default.func.isRequired,onRepoItemClick:d.default.func.isRequired},h=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onToggleClick=function(){n.setState({isShowChildren:!n.state.isShowChildren})},n.onDirentItemClick=function(e,t){var a=n.props.repo;n.props.onDirentItemClick(a,e,t)},n.onRepoItemClick=function(){n.isCurrentRepo()?n.onToggleClick():n.props.onRepoItemClick(n.props.repo)},n.isCurrentRepo=function(){var e=n.props,t=e.selectedRepo,a=e.repo;return t&&a.repo_id===t.repo_id},n.state={isShowChildren:n.props.initToShowChildren},n}return i(t,e),s(t,[{key:"render",value:function(){var e=!1;return this.isCurrentRepo()&&!this.props.selectedPath&&(e=!0),u.default.createElement("li",{className:"file-chooser-item"},u.default.createElement("span",{className:"item-toggle fa "+(this.state.isShowChildren?"fa-caret-down":"fa-caret-right"),onClick:this.onToggleClick}),u.default.createElement("span",{className:"item-info "+(e?"item-active":""),onClick:this.onRepoItemClick},u.default.createElement("span",{className:"icon far fa-folder"}),u.default.createElement("span",{className:"name user-select-none ellipsis"},this.props.repo.repo_name)),this.state.isShowChildren&&u.default.createElement(p.default,{repo:this.props.repo,isShowChildren:this.state.isShowChildren,onDirentItemClick:this.onDirentItemClick,selectedRepo:this.props.selectedRepo,selectedPath:this.props.selectedPath,isShowFile:this.props.isShowFile}))}}]),t}(u.default.Component);h.propTypes=m,t.default=h},44:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(3),p=n(14),m=a(p),h=n(45),Y=a(h),Z=n(4),S={isShowFile:d.default.bool,selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,isShowChildren:d.default.bool.isRequired,onDirentItemClick:d.default.func.isRequired},L=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={direntList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repo;f.seafileAPI.listDir(t.repo_id,"/").then(function(t){var n=[];t.data.dirent_list.forEach(function(t){if(!0===e.props.isShowFile){var a=new m.default(t);n.push(a)}else if("dir"===t.type){var o=new m.default(t);n.push(o)}}),n=Z.Utils.sortDirents(n,"name","asc"),e.setState({direntList:n})})}},{key:"render",value:function(){var e=this,t=this.state.direntList;return u.default.createElement("ul",{className:"list-view-content "+(this.props.isShowChildren?"":"hide")},t.map(function(t,n){return u.default.createElement(Y.default,{key:n,repo:e.props.repo,dirent:t,selectedRepo:e.props.selectedRepo,onDirentItemClick:e.props.onDirentItemClick,selectedPath:e.props.selectedPath,isShowFile:e.props.isShowFile})}))}}]),t}(u.default.Component);L.propTypes=S,t.default=L},45:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(3),p=n(14),m=a(p),h=n(4),Y={isShowFile:d.default.bool,filePath:d.default.string,selectedPath:d.default.string,selectedRepo:d.default.object,dirent:d.default.object.isRequired,repo:d.default.object.isRequired,onDirentItemClick:d.default.func.isRequired},Z=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onItemClick=function(e){e.stopPropagation(),n.props.selectedRepo.repo_id===n.props.repo.repo_id?n.props.selectedPath!==n.state.filePath?n.props.onDirentItemClick(n.state.filePath,n.props.dirent):"dir"===n.props.dirent.type&&n.onToggleClick(e):n.props.onDirentItemClick(n.state.filePath,n.props.dirent)},n.onToggleClick=function(e){e.stopPropagation(),n.state.hasRequest||f.seafileAPI.listDir(n.props.repo.repo_id,n.state.filePath).then(function(e){var t=[];e.data.dirent_list.forEach(function(e){if(!0===n.props.isShowFile){var a=new m.default(e);t.push(a)}else if("dir"===e.type){var o=new m.default(e);t.push(o)}}),t=h.Utils.sortDirents(t,"name","asc"),n.setState({hasRequest:!0,direntList:t}),0!==e.data.length&&0!==t.length||n.setState({hasChildren:!1})}),n.setState({isShowChildren:!n.state.isShowChildren})},n.renderChildren=function(){return u.default.createElement("ul",{className:"list-view-content"},n.state.direntList.map(function(e,a){return u.default.createElement(t,{key:a,dirent:e,repo:n.props.repo,filePath:n.state.filePath,onItemClick:n.onItemClick,selectedPath:n.props.selectedPath,selectedRepo:n.props.selectedRepo,onDirentItemClick:n.props.onDirentItemClick,isShowFile:n.props.isShowFile})}))};var a=n.props.filePath?n.props.filePath+"/"+n.props.dirent.name:"/"+n.props.dirent.name;return n.state={isShowChildren:!1,hasRequest:!1,hasChildren:!0,filePath:a,direntList:[]},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.selectedRepo.repo_id===this.props.repo.repo_id,t=this.props.selectedPath===this.state.filePath;return u.default.createElement("li",{className:"file-chooser-item"},this.state.hasChildren&&"file"!==this.props.dirent.type&&u.default.createElement("span",{className:"item-toggle fa "+(this.state.isShowChildren?"fa-caret-down":"fa-caret-right"),onClick:this.onToggleClick}),u.default.createElement("span",{className:"item-info "+(e&&t?"item-active":""),onClick:this.onItemClick},u.default.createElement("span",{className:"icon far "+("dir"===this.props.dirent.type?"fa-folder":"fa-file")}),u.default.createElement("span",{className:"name user-select-none ellipsis"},this.props.dirent&&this.props.dirent.name)),this.state.isShowChildren&&this.renderChildren())}}]),t}(u.default.Component);Z.propTypes=Y,t.default=Z},46:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(47),p=a(f),m={searchResults:d.default.array.isRequired,onItemClick:d.default.func.isRequired},h=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemClick=function(e){n.setState({currentItem:e}),n.props.onItemClick(e)},n.state={currentItem:null},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this;return u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"8%"}),u.default.createElement("th",{width:"92%"}))),u.default.createElement("tbody",null,this.props.searchResults.map(function(t,n){return u.default.createElement(p.default,{key:n,item:t,currentItem:e.state.currentItem,onItemClick:e.onItemClick})})))}}]),t}(u.default.Component);h.propTypes=m,t.default=h},47:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(4),p={currentItem:d.default.object,onItemClick:d.default.func.isRequired},m=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({highlight:!0})},n.onMouseLeave=function(){n.setState({highlight:!1})},n.onClick=function(){var e=n.props.item;n.props.onItemClick(e)},n.state={highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.currentItem,a=t.is_dir?f.Utils.getFolderIconUrl(!1,192):f.Utils.getFileIconUrl(t.name,192),o=this.state.highlight?"tr-highlight":"";return n&&t.repo_id===n.repo_id&&t.path===n.path&&(o="searched-active"),u.default.createElement("tr",{className:o,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{className:"item-img",src:a,alt:"",width:"24"})),u.default.createElement("td",null,u.default.createElement("span",{className:"item-link"},t.repo_name,"/",t.link_content)))}}]),t}(u.default.Component);m.propTypes=p,t.default=m},48:function(e,t){},49:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(2),p=n(5),m=n(3),h=n(23),Y=a(h),Z=n(19),S=a(Z),L=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.user_info.name)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.is_admin?"admin":e.permission;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},e.user_info.nickname),u.default.createElement("td",null,u.default.createElement(S.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,f.gettext)("Delete")})))}}]),t}(u.default.Component),C=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.items;return u.default.createElement("tbody",null,t.map(function(t,n){return u.default.createElement(L,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(u.default.Component),g={isGroupOwnedRepo:d.default.bool,itemPath:d.default.string.isRequired,itemType:d.default.string.isRequired,repoID:d.default.string.isRequired},X=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e}),n.options=[]},n.setPermission=function(e){n.setState({permission:e})},n.shareToUser=function(){var e=[],t=n.props.itemPath,a=n.props.repoID;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var o=0;o<n.state.selectedOption.length;o++)e[o]=n.state.selectedOption[o].email;n.props.isGroupOwnedRepo?m.seafileAPI.shareGroupOwnedRepoToUser(a,n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];var o=e.data.success.map(function(e){return{user_info:{nickname:e.user_name,name:e.user_email},permission:e.permission,share_type:"user"}});n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(o),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()}).catch(function(e){if(e.response){var t=(0,f.gettext)("Library can not be shared to owner."),a=[];a.push(t),n.setState({errorMsg:a,selectedOption:null})}}):m.seafileAPI.shareFolder(a,t,"user",n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(e.data.success),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()}).catch(function(e){if(e.response){var t=(0,f.gettext)("Library can not be shared to owner."),a=[];a.push(t),n.setState({errorMsg:a,selectedOption:null})}})},n.deleteShareItem=function(e){var t=n.props.itemPath,a=n.props.repoID;n.props.isGroupOwnedRepo?m.seafileAPI.deleteGroupOwnedRepoSharedUserItem(a,e).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.user_info.name!==e})})}):m.seafileAPI.deleteShareToUserItem(a,t,"user",e).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.user_info.name!==e})})})},n.onChangeUserPermission=function(e,t){var a=n.props.itemPath,o=n.props.repoID,r=e.user_info.name;n.props.isGroupOwnedRepo?m.seafileAPI.modifyGroupOwnedRepoUserSharedPermission(o,t,r).then(function(){n.updateSharedItems(e,t)}):m.seafileAPI.updateShareToUserItemPermission(o,a,"user",r,t).then(function(){n.updateSharedItems(e,t)})},n.updateSharedItems=function(e,t){var a=e.user_info.name,o=n.state.sharedItems.map(function(e){var n=e.user_info.name;return a===n&&(e.permission=t),e.is_admin="admin"===t,e});n.setState({sharedItems:o})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=[],"library"===n.props.itemType?n.permissions=["rw","r","admin","cloud-edit","preview"]:"dir"===n.props.itemType&&(n.permissions=["rw","r","cloud-edit","preview"]),!n.props.isGroupOwnedRepo&&f.isPro||(n.permissions=["rw","r"]),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.itemPath,n=this.props.repoID;m.seafileAPI.listSharedItems(n,t,"user").then(function(t){0!==t.data.length&&e.setState({sharedItems:t.data})})}},{key:"render",value:function(){var e=this.state.sharedItems;return u.default.createElement(l.Fragment,null,u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%"},(0,f.gettext)("User")),u.default.createElement("th",{width:"35%"},(0,f.gettext)("Permission")),u.default.createElement("th",{width:"15%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(Y.default,{ref:"userSelect",isMulti:!0,className:"reviewer-select",placeholder:(0,f.gettext)("Select users..."),onSelectChange:this.handleSelectChange})),u.default.createElement("td",null,u.default.createElement(S.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),u.default.createElement("td",null,u.default.createElement(p.Button,{onClick:this.shareToUser},(0,f.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n="";return n=e.email?e.email+": "+e.error_msg:e,u.default.createElement("tr",{key:t},u.default.createElement("td",{colSpan:3},u.default.createElement("p",{className:"error"},n)))}))),u.default.createElement("div",{className:"share-list-container"},u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%"},(0,f.gettext)("User")),u.default.createElement("th",{width:"35%"},(0,f.gettext)("Permission")),u.default.createElement("th",{width:"15%"}))),u.default.createElement(C,{items:e,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission}))))}}]),t}(u.default.Component);X.propTypes=g,t.default=X},50:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),f=n(1),p=a(f),m=n(5),h=n(37),Y=a(h),Z=n(85),S=a(Z),L=n(2),C=n(3),g=n(19),X=a(g),J=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.group_info.id)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return s(t,e),u(t,[{key:"render",value:function(){var e=this.props.item;return d.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},d.default.createElement("td",{className:"name"},e.group_info.name),d.default.createElement("td",null,d.default.createElement(X.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),d.default.createElement("td",null,d.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,L.gettext)("Delete")})))}}]),t}(d.default.Component),D=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props.items;return d.default.createElement("tbody",null,t.map(function(t,n){return d.default.createElement(J,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(d.default.Component),P={isGroupOwnedRepo:p.default.bool,itemPath:p.default.string.isRequired,itemType:p.default.string.isRequired,repoID:p.default.string.isRequired},w=function(e){return d.default.createElement("div",l({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,L.gettext)("Group not found"))},T=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){C.seafileAPI.shareableGroups().then(function(e){n.options=[];for(var t=0;t<e.data.length;t++){var a={};a.value=e.data[t].name,a.id=e.data[t].id,a.label=e.data[t].name,n.options.push(a)}})},n.listSharedGroups=function(){var e=n.props.itemPath,t=n.props.repoID;C.seafileAPI.listSharedItems(t,e,"group").then(function(e){0!==e.data.length&&n.setState({sharedItems:e.data})})},n.setPermission=function(e){n.setState({permission:e})},n.shareToGroup=function(){var e=[],t=n.props.itemPath,a=n.props.repoID,o=n.props.isGroupOwnedRepo;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var r=0;r<n.state.selectedOption.length;r++)e[r]=n.state.selectedOption[r].id;o?C.seafileAPI.shareGroupOwnedRepoToGroup(a,n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];var o=e.data.success.map(function(e){return{group_info:{id:e.group_id,name:e.group_name},permission:e.permission,share_type:"group"}});n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(o),selectedOption:null,permission:"rw"})}):C.seafileAPI.shareFolder(a,t,"group",n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(e.data.success),selectedOption:null,permission:"rw"})})},n.deleteShareItem=function(e){var t=n.props.itemPath,a=n.props.repoID;n.props.isGroupOwnedRepo?C.seafileAPI.deleteGroupOwnedRepoSharedGroupItem(a,e).then(function(){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.group_info.id!==e})})}):C.seafileAPI.deleteShareToGroupItem(a,t,"group",e).then(function(){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.group_info.id!==e})})})},n.onChangeUserPermission=function(e,t){var a=n.props.itemPath,o=n.props.repoID,r=e.group_info.id;n.props.isGroupOwnedRepo?C.seafileAPI.modifyGroupOwnedRepoGroupSharedPermission(o,t,r).then(function(){n.updateSharedItems(e,t)}):C.seafileAPI.updateShareToGroupItemPermission(o,a,"group",r,t).then(function(){n.updateSharedItems(e,t)})},n.updateSharedItems=function(e,t){var a=e.group_info.id,o=n.state.sharedItems.map(function(e){var n=e.group_info.id;return a===n&&(e.permission=t),e});n.setState({sharedItems:o})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=[],"library"===n.props.itemType?n.permissions=["rw","r","admin","cloud-edit","preview"]:"dir"===n.props.itemType&&(n.permissions=["rw","r","cloud-edit","preview"]),!n.props.isGroupOwnedRepo&&L.isPro||(n.permissions=["rw","r"]),n}return s(t,e),u(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listSharedGroups()}},{key:"render",value:function(){return d.default.createElement(c.Fragment,null,d.default.createElement("table",null,d.default.createElement("thead",null,d.default.createElement("tr",null,d.default.createElement("th",{width:"50%"},(0,L.gettext)("Group")),d.default.createElement("th",{width:"35%"},(0,L.gettext)("Permission")),d.default.createElement("th",{width:"15%"}))),d.default.createElement("tbody",null,d.default.createElement("tr",null,d.default.createElement("td",null,d.default.createElement(Y.default,o({isMulti:!0,onChange:this.handleSelectChange,options:this.options,placeholder:(0,L.gettext)("Select a group"),components:(0,S.default)(),maxMenuHeight:200,inputId:"react-select-2-input",value:this.state.selectedOption},"components",{NoOptionsMessage:w}))),d.default.createElement("td",null,d.default.createElement(X.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),d.default.createElement("td",null,d.default.createElement(m.Button,{onClick:this.shareToGroup},(0,L.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n=e.group_name+": "+e.error_msg;return d.default.createElement("tr",{key:t},d.default.createElement("td",{colSpan:3},d.default.createElement("p",{className:"error"},n)))}))),d.default.createElement("div",{className:"share-list-container"},d.default.createElement("table",{className:"table-thead-hidden"},d.default.createElement("thead",null,d.default.createElement("tr",null,d.default.createElement("th",{width:"50%"},(0,L.gettext)("Group")),d.default.createElement("th",{width:"35%"},(0,L.gettext)("Permission")),d.default.createElement("th",{width:"15%"}))),d.default.createElement(D,{items:this.state.sharedItems,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission}))))}}]),t}(d.default.Component);T.propTypes=P,t.default=T},51:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(6),p=a(f),m=n(39),h=a(m),Y=n(5),Z=n(2),S=n(3),L=n(40),C=a(L),g=n(7),X=a(g),J={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired,closeShareDialog:d.default.func.isRequired},D=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getShareLink=function(){var e=n.props.itemPath,t=n.props.repoID;S.seafileAPI.getShareLink(t,e).then(function(e){if(0!==e.data.length){var t=new C.default(e.data[0]);n.setState({sharedLinkInfo:t})}})},n.onPasswordInputChecked=function(){n.setState({isShowPasswordInput:!n.state.isShowPasswordInput,password:"",passwdnew:"",errorInfo:""})},n.togglePasswordVisible=function(){n.setState({isPasswordVisible:!n.state.isPasswordVisible})},n.generatePassword=function(){var e=Math.random().toString(36).substr(5);n.setState({password:e,passwdnew:e})},n.inputPassword=function(e){var t=e.target.value.trim();n.setState({password:t})},n.inputPasswordNew=function(e){var t=e.target.value.trim();n.setState({passwdnew:t})},n.setPermission=function(e){n.permissions="previewAndDownload"==e?{can_edit:!1,can_download:!0}:{can_edit:!1,can_download:!1}},n.generateShareLink=function(){if(n.validateParamsInput()){n.setState({errorInfo:""});var e=n.props,t=e.itemPath,a=e.repoID,o=n.state,r=o.password,i=o.expireDays,s=n.permissions;s=JSON.stringify(s),S.seafileAPI.createShareLink(a,t,r,i,s).then(function(e){var t=new C.default(e.data);n.setState({sharedLinkInfo:t})})}},n.onCopySharedLink=function(){var e=n.state.sharedLinkInfo.link;(0,h.default)(e),X.default.success((0,Z.gettext)("Share link is copied to the clipboard.")),n.props.closeShareDialog()},n.onCopyDownloadLink=function(){var e=n.state.sharedLinkInfo.link+"?dl";(0,h.default)(e),X.default.success((0,Z.gettext)("Direct download link is copied to the clipboard.")),n.props.closeShareDialog()},n.deleteShareLink=function(){var e=n.state.sharedLinkInfo;S.seafileAPI.deleteShareLink(e.token).then(function(){n.setState({password:"",passwordnew:"",isShowPasswordInput:!1,expireDays:"",isExpireChecked:!1,errorInfo:"",sharedLinkInfo:null,isNoticeMessageShow:!1}),n.permissions={can_edit:!1,can_download:!0}})},n.onExpireChecked=function(e){n.setState({isExpireChecked:e.target.checked})},n.onExpireDaysChanged=function(e){var t=e.target.value.trim();n.setState({expireDays:t})},n.validateParamsInput=function(){var e=n.state,t=e.isShowPasswordInput,a=e.password,o=e.passwdnew,r=e.isExpireChecked,i=e.expireDays;if(t){if(0===a.length)return n.setState({errorInfo:"Please enter password"}),!1;if(a.length<8)return n.setState({errorInfo:"Password is too short"}),!1;if(a!==o)return n.setState({errorInfo:"Passwords don't match"}),!1}var s=/^\d+$/;if(n.isExpireDaysNoLimit){if(r){if(!i)return n.setState({errorInfo:"Please enter days"}),!1;var l=s.test(i);if(!l)return n.setState({errorInfo:"Please enter a non-negative integer"}),!1;n.setState({expireDays:parseInt(i)})}}else{if(!i)return n.setState({errorInfo:"Please enter days"}),!1;if(!s.test(i))return n.setState({errorInfo:"Please enter a non-negative integer"}),!1;i=parseInt(i);var u=parseInt(Z.shareLinkExpireDaysMin),c=parseInt(Z.shareLinkExpireDaysMax);if(0!==u&&c!==c&&i<u)return n.setState({errorInfo:"Please enter valid days"}),!1;if(0===u&&0!==c&&i>c)return n.setState({errorInfo:"Please enter valid days"}),!1;if(0!==u&&0!==c&&(i<u||i<c))return n.setState({errorInfo:"Please enter valid days"}),!1;n.setState({expireDays:i})}return!0},n.onNoticeMessageToggle=function(){n.setState({isNoticeMessageShow:!n.state.isNoticeMessageShow})},n.state={isValidate:!1,isShowPasswordInput:!1,isPasswordVisible:!1,isExpireChecked:!1,password:"",passwdnew:"",expireDays:"",errorInfo:"",sharedLinkInfo:null,isNoticeMessageShow:!1},n.permissions={can_edit:!1,can_download:!0},n.isExpireDaysNoLimit=0===parseInt(Z.shareLinkExpireDaysMin)&&0===parseInt(Z.shareLinkExpireDaysMax),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getShareLink()}},{key:"render",value:function(){var e=this;if(this.state.sharedLinkInfo){var t=this.state.sharedLinkInfo;return u.default.createElement("div",null,u.default.createElement(Y.Form,{className:"mb-4"},u.default.createElement(Y.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,Z.gettext)("Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,t.link)," ",t.is_expired?u.default.createElement("span",{className:"err-message"},"(",(0,Z.gettext)("Expired"),")"):u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopySharedLink}))),!t.is_dir&&u.default.createElement(Y.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,Z.gettext)("Direct Download Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,t.link,"?dl")," ",t.is_expired?u.default.createElement("span",{className:"err-message"},"(",(0,Z.gettext)("Expired"),")"):u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyDownloadLink}))),t.expire_date&&u.default.createElement(Y.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,Z.gettext)("Expiration Date:")),u.default.createElement("dd",null,(0,p.default)(t.expire_date).format("YYYY-MM-DD hh:mm:ss")))),this.state.isNoticeMessageShow?u.default.createElement("div",{className:"alert alert-warning"},u.default.createElement("h4",{className:"alert-heading"},(0,Z.gettext)("Are you sure you want to delete the share link?")),u.default.createElement("p",{className:"mb-4"},(0,Z.gettext)("If the share link is deleted, no one will be able to access it any more.")),u.default.createElement("button",{className:"btn btn-primary",onClick:this.deleteShareLink},(0,Z.gettext)("Delete"))," ",u.default.createElement("button",{className:"btn btn-secondary",onClick:this.onNoticeMessageToggle},(0,Z.gettext)("Cancel"))):u.default.createElement(Y.Button,{onClick:this.onNoticeMessageToggle},(0,Z.gettext)("Delete")))}return u.default.createElement(Y.Form,{className:"generate-share-link"},u.default.createElement(Y.FormGroup,{check:!0},u.default.createElement(Y.Label,{check:!0},u.default.createElement(Y.Input,{type:"checkbox",onChange:this.onPasswordInputChecked}),"  ",(0,Z.gettext)("Add password protection"))),this.state.isShowPasswordInput&&u.default.createElement(Y.FormGroup,{className:"link-operation-content"},u.default.createElement(Y.Label,{className:"font-weight-bold"},(0,Z.gettext)("Password"))," ",u.default.createElement("span",{className:"tip"},(0,Z.gettext)("(at least 8 characters)")),u.default.createElement(Y.InputGroup,{className:"passwd"},u.default.createElement(Y.Input,{type:this.state.isPasswordVisible?"text":"password",value:this.state.password||"",onChange:this.inputPassword}),u.default.createElement(Y.InputGroupAddon,{addonType:"append"},u.default.createElement(Y.Button,{onClick:this.togglePasswordVisible},u.default.createElement("i",{className:"link-operation-icon fas "+(this.state.isPasswordVisible?"fa-eye":"fa-eye-slash")})),u.default.createElement(Y.Button,{onClick:this.generatePassword},u.default.createElement("i",{className:"link-operation-icon fas fa-magic"})))),u.default.createElement(Y.Label,{className:"font-weight-bold"},(0,Z.gettext)("Password again")),u.default.createElement(Y.Input,{className:"passwd",type:this.state.isPasswordVisible?"text":"password",value:this.state.passwdnew||"",onChange:this.inputPasswordNew})),this.isExpireDaysNoLimit&&u.default.createElement(Y.FormGroup,{check:!0},u.default.createElement(Y.Label,{check:!0},u.default.createElement(Y.Input,{className:"expire-checkbox",type:"checkbox",onChange:this.onExpireChecked}),"  ",(0,Z.gettext)("Add auto expiration"),u.default.createElement(Y.Input,{className:"expire-input",type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged,readOnly:!this.state.isExpireChecked}),u.default.createElement("span",null,(0,Z.gettext)("days")))),!this.isExpireDaysNoLimit&&u.default.createElement(Y.FormGroup,{check:!0},u.default.createElement(Y.Label,{check:!0},u.default.createElement(Y.Input,{className:"expire-checkbox",type:"checkbox",onChange:this.onExpireChecked,checked:!0,readOnly:!0}),"  ",(0,Z.gettext)("Add auto expiration"),u.default.createElement(Y.Input,{className:"expire-input",type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged})," ",u.default.createElement("span",null,(0,Z.gettext)("days")),0!==parseInt(Z.shareLinkExpireDaysMin)&&0!==parseInt(Z.shareLinkExpireDaysMax)&&u.default.createElement("span",null," (",Z.shareLinkExpireDaysMin," - ",Z.shareLinkExpireDaysMax," ",(0,Z.gettext)("days"),")"),0!==parseInt(Z.shareLinkExpireDaysMin)&&0===parseInt(Z.shareLinkExpireDaysMax)&&u.default.createElement("span",null," (",(0,Z.gettext)("Greater than or equal to")," ",Z.shareLinkExpireDaysMin," ",(0,Z.gettext)("days"),")"),0===parseInt(Z.shareLinkExpireDaysMin)&&0!==parseInt(Z.shareLinkExpireDaysMax)&&u.default.createElement("span",null," (",(0,Z.gettext)("Less than or equal to")," ",Z.shareLinkExpireDaysMax," ",(0,Z.gettext)("days"),")"))),u.default.createElement(Y.FormGroup,{check:!0},u.default.createElement(Y.Label,{check:!0},u.default.createElement(Y.Input,{type:"checkbox",checked:!0,readOnly:!0}),"  ",(0,Z.gettext)("Set permission"))),u.default.createElement(Y.FormGroup,{check:!0,className:"permission"},u.default.createElement(Y.Label,{check:!0},u.default.createElement(Y.Input,{type:"radio",name:"radio1",defaultChecked:!0,onChange:function(){return e.setPermission("previewAndDownload")}}),"  ",(0,Z.gettext)("Preview and download"))),u.default.createElement(Y.FormGroup,{check:!0,className:"permission"},u.default.createElement(Y.Label,{check:!0},u.default.createElement(Y.Input,{type:"radio",name:"radio1",onChange:function(){return e.setPermission("preview")}}),"  ",(0,Z.gettext)("Preview only"))),this.state.errorInfo&&u.default.createElement(Y.Alert,{color:"danger",className:"mt-2"},(0,Z.gettext)(this.state.errorInfo)),u.default.createElement(Y.Button,{onClick:this.generateShareLink},(0,Z.gettext)("Generate")))}}]),t}(u.default.Component);D.propTypes=J,t.default=D},52:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(39),p=a(f),m=n(5),h=n(2),Y=n(3),Z=n(41),S=a(Z),L=n(7),C=a(L),g={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired,closeShareDialog:d.default.func.isRequired},X=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getUploadLink=function(){var e=n.props.itemPath,t=n.props.repoID;Y.seafileAPI.getUploadLinks(t,e).then(function(e){if(0!==e.data.length){var t=new S.default(e.data[0]);n.setState({sharedUploadInfo:t})}})},n.addPassword=function(){n.setState({showPasswordInput:!n.state.showPasswordInput,password:"",passwdnew:"",errorInfo:""})},n.togglePasswordVisible=function(){n.setState({passwordVisible:!n.state.passwordVisible})},n.generatePassword=function(){var e=Math.random().toString(36).substr(5);n.setState({password:e,passwordnew:e})},n.inputPassword=function(e){n.setState({password:e.target.value})},n.inputPasswordNew=function(e){n.setState({passwordnew:e.target.value})},n.generateUploadLink=function(){var e=n.props.itemPath,t=n.props.repoID;n.state.showPasswordInput&&""==n.state.password?n.setState({errorInfo:(0,h.gettext)("Please enter password")}):n.state.showPasswordInput&&n.state.showPasswordInput&&n.state.password.length<8?n.setState({errorInfo:(0,h.gettext)("Password is too short")}):n.state.showPasswordInput&&n.state.password!==n.state.passwordnew?n.setState({errorInfo:(0,h.gettext)("Passwords don't match")}):Y.seafileAPI.createUploadLink(t,e,n.state.password).then(function(e){var t=new S.default(e.data);n.setState({sharedUploadInfo:t})})},n.onCopyUploadLink=function(){var e=n.state.sharedUploadInfo.link;(0,p.default)(e),C.default.success((0,h.gettext)("Upload link is copied to the clipboard.")),n.props.closeShareDialog()},n.deleteUploadLink=function(){var e=n.state.sharedUploadInfo;Y.seafileAPI.deleteUploadLink(e.token).then(function(){n.setState({showPasswordInput:!1,password:"",passwordnew:"",sharedUploadInfo:null})})},n.state={showPasswordInput:!1,passwordVisible:!1,password:"",passwdnew:"",sharedUploadInfo:null},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getUploadLink()}},{key:"render",value:function(){if(this.state.sharedUploadInfo){var e=this.state.sharedUploadInfo;return u.default.createElement("div",null,u.default.createElement(m.Form,{className:"mb-4"},u.default.createElement(m.FormGroup,null,u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,h.gettext)("Upload Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,e.link),u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyUploadLink})))),u.default.createElement(m.Button,{onClick:this.deleteUploadLink},(0,h.gettext)("Delete")))}return u.default.createElement(m.Form,{className:"generate-upload-link"},u.default.createElement(m.FormGroup,null,u.default.createElement(m.FormText,{className:"tip"},(0,h.gettext)("You can share the generated link to others and then they can upload files to this directory via the link."))),u.default.createElement(m.FormGroup,{check:!0},u.default.createElement(m.Label,{check:!0},u.default.createElement(m.Input,{type:"checkbox",onChange:this.addPassword}),"  ",(0,h.gettext)("Add password protection"))),this.state.showPasswordInput&&u.default.createElement(m.FormGroup,{className:"link-operation-content"},u.default.createElement(m.Label,{className:"font-weight-bold"},(0,h.gettext)("Password"))," ",u.default.createElement("span",{className:"tip"},(0,h.gettext)("(at least 8 characters)")),u.default.createElement(m.InputGroup,{className:"passwd"},u.default.createElement(m.Input,{type:this.state.passwordVisible?"text":"password",value:this.state.password||"",onChange:this.inputPassword}),u.default.createElement(m.InputGroupAddon,{addonType:"append"},u.default.createElement(m.Button,{onClick:this.togglePasswordVisible},u.default.createElement("i",{className:"link-operation-icon fas "+(this.state.passwordVisible?"fa-eye":"fa-eye-slash")})),u.default.createElement(m.Button,{onClick:this.generatePassword},u.default.createElement("i",{className:"link-operation-icon fas fa-magic"})))),u.default.createElement(m.Label,{className:"font-weight-bold"},(0,h.gettext)("Password again")),u.default.createElement(m.Input,{className:"passwd",type:this.state.passwordVisible?"text":"password",value:this.state.passwordnew||"",onChange:this.inputPasswordNew})),this.state.errorInfo&&u.default.createElement(m.Alert,{color:"danger",className:"mt-2"},this.state.errorInfo),u.default.createElement(m.Button,{className:"generate-link-btn",onClick:this.generateUploadLink},(0,h.gettext)("Generate")))}}]),t}(u.default.Component);X.propTypes=g,t.default=X},53:function(e,t){},541:function(e,t,n){n(12),e.exports=n(543)},543:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var o=n(0),r=a(o),i=n(8),s=a(i),l=n(548),u=a(l),c=n(77),d=n(1132),f=a(d);n(86),n(87),n(88),n(1146);var p=window.app.pageOptions.lang;s.default.render(r.default.createElement(c.I18nextProvider,{i18n:f.default,initialLanguage:p},r.default.createElement(u.default,null)),document.getElementById("root"))},548:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){return"image-"+Date.now().toString()+".png"}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),f=n(549),p=a(f);n(28);var m=n(29),h=n(3),Y=n(4),Z=n(2),S=n(253),L=a(S),C=n(7),g=a(C),X=n(10),J=a(X),D=n(106),P=a(D),w=n(107),T=a(w),y=n(25),v=a(y),M=n(1079),b=a(M),Q=n(1081),H=a(Q),E=n(1082),F=a(E),B=n(195),_=n(1099),N=a(_),R=n(270),G=a(R),W=n(1103),k=a(W),I=n(1104),O=a(I),K=n(58),x=a(K),A=n(1106),j=a(A),U=n(11),q=a(U),V=n(96);n(1107);var z=n(1108),$=n(202),ee=window.app.pageOptions,te=ee.repoID,ne=ee.repoName,ae=ee.filePath,oe=ee.fileName,re=ee.mode,ie=ee.draftID,se=ee.isDraft,le=ee.hasDraft,ue=window.app.config,ce=ue.siteRoot,de=ue.serviceUrl,fe=ue.seafileCollabServer,pe=window.app.userInfo,me=pe.username,he="/",Ye=function(){function e(){var t=this;i(this,e),this.uploadImage=function(e){return h.seafileAPI.getUploadLink(te,he).then(function(t){var n=t.data,a=n+"?ret-json=1",o=s(),r=e.slice(0,-1,"image/png"),i=new File([r],o,{type:"image/png"}),l=new FormData;return l.append("parent_dir","/"),l.append("relative_path","images/auto-upload"),l.append("file",i),{uploadLink:a,formData:l}}).then(function(e){var t=e.uploadLink,n=e.formData;return h.seafileAPI.uploadImage(t,n)}).then(function(e){var n=e.data[0],a=n.name;return t._getImageURL(a)})},this.uploadLocalImage=function(e){return h.seafileAPI.getUploadLink(te,he).then(function(t){var n=t.data+"?ret-json=1",a=new File([e],e.name,{type:e.type}),o=new FormData;return o.append("parent_dir","/"),o.append("relative_path","images/auto-upload"),o.append("file",a),h.seafileAPI.uploadImage(n,o)}).then(function(e){return t._getImageURL(e.data[0].name)})},this.listFileTags=function(){return h.seafileAPI.listFileTags(te,ae)},this.listRepoTags=function(){return h.seafileAPI.listRepoTags(te)},this.repoID=te,this.filePath=ae,this.serviceUrl=de,this.name=pe.name,this.contact_email=pe.contact_email,this.fileName=oe,this.userName=me}return u(e,[{key:"saveContent",value:function(e){return h.seafileAPI.getUpdateLink(te,he).then(function(t){var n=t.data;return h.seafileAPI.updateFile(n,ae,oe,e)})}},{key:"unstarItem",value:function(){return h.seafileAPI.unstarItem(this.repoID,this.filePath)}},{key:"starItem",value:function(){return h.seafileAPI.starItem(this.repoID,this.filePath)}},{key:"getParentDectionaryUrl",value:function(){var e=this.filePath.substring(0,this.filePath.lastIndexOf("/")),t=encodeURIComponent(ne),n=Y.Utils.encodePath(e);return this.serviceUrl+"/library/"+this.repoID+"/"+t+n}},{key:"_getImageURL",value:function(e){return this.serviceUrl+"/lib/"+te+"/file/images/auto-upload/"+e+"?raw=1"}},{key:"getFileURL",value:function(e){return"file"===e.type?e.isImage()?de+"/lib/"+te+"/file"+Y.Utils.encodePath(e.path())+"?raw=1":de+"/lib/"+te+"/file"+Y.Utils.encodePath(e.path()):de+"/library/"+te+"/"+encodeURIComponent(ne)+Y.Utils.encodePath(e.path())}},{key:"isInternalFileLink",value:function(e){return new RegExp(this.serviceUrl+"/lib/[0-9a-f-]{36}/file.*").test(e)}},{key:"isInternalDirLink",value:function(e){return new RegExp(de+"/library/[0-9a-f-]{36}.*").test(e)}},{key:"getFiles",value:function(){return h.seafileAPI.listDir(te,he,{recursive:!0}).then(function(e){return e.data.dirent_list.map(function(e){return{name:e.name,type:"dir"===e.type?"dir":"file",parent_path:e.parent_dir}})})}},{key:"getFileHistory",value:function(){return h.seafileAPI.getFileHistory(te,ae)}},{key:"getFileInfo",value:function(){return h.seafileAPI.getFileInfo(te,ae)}},{key:"getRepoInfo",value:function(e){return h.seafileAPI.getRepoInfo(e)}},{key:"getInternalLink",value:function(){return h.seafileAPI.getInternalLink(te,ae)}},{key:"getShareLink",value:function(){return h.seafileAPI.getShareLink(te,ae)}},{key:"createShareLink",value:function(e,t,n,a,o){return h.seafileAPI.createShareLink(e,t,n,a,o)}},{key:"deleteShareLink",value:function(e){return h.seafileAPI.deleteShareLink(e)}},{key:"getDraftKey",value:function(){return te+ae}},{key:"getFileContent",value:function(e){return h.seafileAPI.getFileContent(e)}},{key:"listFileHistoryRecords",value:function(e,t){return h.seafileAPI.listFileHistoryRecords(te,ae,e,t)}},{key:"getFileHistoryVersion",value:function(e,t){return h.seafileAPI.getFileRevision(te,e,t)}},{key:"getCommentsNumber",value:function(){return h.seafileAPI.getCommentsNumber(this.repoID,ae)}},{key:"postComment",value:function(e,t){return h.seafileAPI.postComment(this.repoID,this.filePath,e,t)}},{key:"listComments",value:function(){return h.seafileAPI.listComments(this.repoID,this.filePath)}},{key:"updateComment",value:function(e,t,n,a){return h.seafileAPI.updateComment(this.repoID,e,t,n,a)}},{key:"deleteComment",value:function(e){return h.seafileAPI.deleteComment(this.repoID,e)}},{key:"getUserAvatar",value:function(e){return h.seafileAPI.getUserAvatar(me,e)}},{key:"goDraftPage",value:function(){window.location.href=de+"/drafts/"+ie+"/"}},{key:"createDraftFile",value:function(){return h.seafileAPI.createDraft(te,ae).then(function(e){window.location.href=de+"/lib/"+e.data.origin_repo_id+"/file"+Y.Utils.encodePath(e.data.draft_file_path)+"?mode=edit"})}},{key:"publishDraftFile",value:function(){return h.seafileAPI.publishDraft(ie).then(function(e){window.location.href=de+"/lib/"+te+"/file"+Y.Utils.encodePath(e.data.published_file_path)})}},{key:"fileMetaData",value:function(){return h.seafileAPI.fileMetaData(te,ae)}},{key:"markdownLint",value:function(e){return h.seafileAPI.markdownLint(e)}}]),e}(),Ze=new Ye,Se=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(n.emitSwitchEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(pe&&n.state.collabServer){var t=n.state.fileInfo,a=t.repoID,o=t.path;n.socket.emit("presence",{request:"editing",doc_id:z.MD5(a+o).toString(),user:pe,is_editing:e})}},n.toggleCancel=function(){n.setState({showRelatedFileDialog:!1,showEditFileTagDialog:!1,showMarkdownEditorDialog:!1,showShareLinkDialog:!1,showCommentDialog:!1,showInsertFileDialog:!1})},n.setEditorMode=function(e){n.setState({editorMode:e})},n.setDraftValue=function(e,t){"rich"===e?n.draftRichValue=t:n.draftPlainValue=t},n.setContent=function(e){var t=(0,B.deserialize)(e);n.setState({markdownContent:e,value:t})},n.checkDraft=function(){var e=Ze.getDraftKey(),t=localStorage.getItem(e),a=n;t&&(a.setState({localDraftDialog:!0}),a.localDraft=t,localStorage.removeItem(e))},n.useDraft=function(){n.setState({localDraftDialog:!1,loading:!1,markdownContent:n.localDraft,editorMode:"rich"}),n.emitSwitchEditor(!0)},n.deleteDraft=function(){if(n.state.localDraftDialog)n.setState({localDraftDialog:!1,loading:!1});else{var e=Ze.getDraftKey();localStorage.removeItem(e)}},n.closeDraftDialog=function(){n.setState({localDraftDialog:!1})},n.clearTimer=function(){clearTimeout(n.timer),n.timer=null},n.openDialogs=function(e){switch(e){case"related_files":n.state.relatedFiles.length>0?n.setState({showRelatedFileDialog:!0,showMarkdownEditorDialog:!0,viewMode:"list_related_file"}):n.setState({showRelatedFileDialog:!0,showMarkdownEditorDialog:!0,viewMode:"add_related_file"});break;case"tags":n.setState({showEditFileTagDialog:!0,showMarkdownEditorDialog:!0});break;case"share_link":n.setState({showMarkdownEditorDialog:!0,showShareLinkDialog:!0});break;case"comment":n.setState({showMarkdownEditorDialog:!0,showCommentDialog:!0});break;case"insert_file":n.setState({showMarkdownEditorDialog:!0,showInsertFileDialog:!0});break;default:return}},n.listRelatedFiles=function(){h.seafileAPI.listRelatedFiles(te,ae).then(function(e){n.setState({relatedFiles:e.data.related_files})})},n.listFileTags=function(){h.seafileAPI.listFileTags(te,ae).then(function(e){for(var t=e.data.file_tags,a=0,o=t.length;a<o;a++)t[a].id=t[a].file_tag_id;n.setState({fileTagList:t})})},n.onRelatedFileChange=function(){n.listRelatedFiles()},n.onFileTagChanged=function(){n.listFileTags()},n.setFileInfoMtime=function(e){n.setState({fileInfo:Object.assign({},n.state.fileInfo,{mtime:e.mtime,id:e.id,lastModifier:e.last_modifier_name})})},n.toggleStar=function(){var e=n.state.fileInfo.starred;e?Ze.unstarItem().then(function(t){n.setState({fileInfo:Object.assign({},n.state.fileInfo,{starred:!e})})}):e||Ze.starItem().then(function(t){n.setState({fileInfo:Object.assign({},n.state.fileInfo,{starred:!e})})})},n.autoSaveDraft=function(){var e=n;e.timer||(e.timer=setTimeout(function(){var t="";if("rich"==n.state.editorMode){var a=n.draftRichValue;t=(0,B.serialize)(a.toJSON())}else"plain"==n.state.editorMode&&(t=n.draftPlainValue);var o=Ze.getDraftKey();localStorage.setItem(o,t),e.setState({showDraftSaved:!0}),setTimeout(function(){e.setState({showDraftSaved:!1})},3e3),e.timer=null},6e4))},n.backToParentDirectory=function(){window.location.href=Ze.getParentDectionaryUrl()},n.onEdit=function(e){e.preventDefault(),n.setEditorMode("rich")},n.toggleShareLinkDialog=function(){n.openDialogs("share_link")},n.getCommentsNumber=function(){Ze.getCommentsNumber().then(function(e){var t=e.data[Object.getOwnPropertyNames(e.data)[0]];n.setState({commentsNumber:t})})},n.onCommentAdded=function(){n.getCommentsNumber(),n.toggleCancel()},n.showDiffViewer=function(){n.setState({loadingDiff:!1})},n.setDiffViewerContent=function(e,t){n.setState({markdownContent:e,oldMarkdownContent:t}),n.showDiffViewer()},n.reloadDiffContent=function(){n.setState({loadingDiff:!0})},n.setBtnPosition=function(e){if(n.state.isShowComments){var t=window.getSelection();if(!t.rangeCount)return void(n.range=null);if(!1===t.isCollapsed){var a=t.getRangeAt(0),o=t.focusNode;if("I"===o.tagName||3!==o.nodeType&&"language-type"===o.getAttribute("class")){var r=a.cloneContents(),i=r.firstChild.firstChild;if(!i)return;var s=document.createRange();s.setStartBefore(i),s.setEndAfter(i);var l={value:n.state.value};n.range=(0,V.findRange)(a,l)}else{var u={value:n.state.value};n.range=(0,V.findRange)(a,u)}if(!n.range)return;var c=a.getBoundingClientRect();navigator.userAgent.indexOf("Chrome")<0&&navigator.userAgent.indexOf("Safari")>0&&a.collapsed&&0==c.top&&0==c.height&&(0==a.startOffset?a.setEnd(a.endContainer,1):a.setStart(a.startContainer,a.startOffset-1),c=a.getBoundingClientRect(),0==c.top&&0==c.height&&a.getClientRects().length&&(c=a.getClientRects()[0]));var d=n.refs.commentbtn.style;d.top=c.top-63+n.refs.markdownContainer.scrollTop+"px",d.right="0px"}else{n.refs.commentbtn.style.top="-1000px"}}},n.addComment=function(e){e.stopPropagation(),n.getQuote(),n.openDialogs("comment")},n.getQuote=function(){var e=n.range;if(e){var t=n.state.value.document,a=e,o=a.anchor,r=a.focus,i=t.getNode(o.key),s=t.getNode(r.key),l=t.getClosestInline(o.key),u=t.getClosestInline(r.key);if(l&&o.offset==i.text.length){var c=t.getClosestBlock(o.key),d=c.getNextText(o.key);d&&(e=e.moveAnchorTo(d.key,0))}if(u&&r.offset==s.text.length){var f=t.getClosestBlock(r.key),p=f.getNextText(r.key);p&&(e=e.moveFocusTo(p.key,0))}var h=t.getFragmentAtRange(e),Y=n.removeNullNode(h.nodes),Z=m.Document.create({nodes:Y}),S=m.Value.create({document:Z});n.quote=(0,B.serialize)(S.toJSON());var L=t.createSelection(e);L=L.setIsFocused(!0),n.setState({commentPosition:L.anchor.path})}},n.removeNullNode=function(e){var t=[];return e.map(function(e){var a=e.text.trim(),o=e.nodes;if(a)if(o&&1===o.size||!o)t.push(e);else if(o.size>1){var r=n.removeNullNode(o),i=m.Block.create({nodes:r,data:e.data,key:e.key,type:e.type});t.push(i)}}),t},n.scrollToNode=function(e){var t=new $(window.location.href);t.set("hash","user-content-"+e.text),window.location.href=t.toString()},n.findScrollContainer=function(e,t){for(var n=e.parentNode,a=["auto","overlay","scroll"],o=void 0;!o&&n.parentNode;){var r=t.getComputedStyle(n),i=r.overflowY;if(a.includes(i)){o=n;break}n=n.parentNode}return o||t.document.body},n.scrollToQuote=function(e){if(e){var t=window;e.length>2&&(e[0]=e[0]>1?e[0]-1:e[0]+1,e=e.slice(0,1));var a=n.state.value.document.getNode(e);if(a||(e=e.slice(0,1),a=n.state.value.document.getNode(e)),a){for(var o=t.document.querySelector('[data-key="'+a.key+'"]');"CODE"===o.tagName;)o=o.parentNode;var r=n.findScrollContainer(o,t);r==t.document.body||r==t.document.documentElement?t.scrollTo(0,o.offsetTop):r.scrollTop=o.offsetTop}}},n.toggleHistory=function(){if(!Z.isDocs)return void(window.location.href=ce+"repo/file_revisions/"+te+"/?p="+Y.Utils.encodePath(ae));n.state.isShowHistory?n.setState({isShowHistory:!1,isShowOutline:!0,isShowComments:!1}):n.setState({isShowHistory:!0,isShowOutline:!1,isShowComments:!1})},n.toggleCommentList=function(){n.state.isShowComments?n.setState({isShowHistory:!1,isShowOutline:!0,isShowComments:!1}):n.setState({isShowHistory:!1,isShowOutline:!1,isShowComments:!0})},n.getInsertLink=function(e,t){h.seafileAPI.getShareLink(e,t).then(function(n){if(0!==n.data.length){var a=n.data[0];window.richMarkdownEditor.addLink(a.obj_name,a.link)}else{var o={can_edit:!1,can_download:!0};o=JSON.stringify(o),h.seafileAPI.createShareLink(e,t,null,null,o).then(function(e){var t=e.data;window.richMarkdownEditor.addLink(t.obj_name,t.link)})}})},n.timer=null,n.localDraft="",n.autoSave=!1,n.draftRichValue="",n.draftPlainValue="",n.state={markdownContent:"",oldMarkdownContent:"",loading:!0,mode:"editor",fileInfo:{repoID:te,name:oe,path:ae,mtime:null,size:0,starred:!1,permission:"",lastModifier:"",id:""},editorMode:"viewer",collabServer:fe||null,relatedFiles:[],fileTagList:[],localDraftDialog:!1,showRelatedFileDialog:!1,showEditFileTagDialog:!1,showMarkdownEditorDialog:!1,showShareLinkDialog:!1,showCommentDialog:!1,showInsertFileDialog:!1,showDraftSaved:!1,collabUsers:pe?[{user:pe,is_editing:!1}]:[],commentsNumber:null,loadingDiff:!1,value:null,isShowComments:!1,isShowHistory:!1,isShowOutline:!0,viewMode:"list_related_file"},n.state.collabServer){var a=(0,L.default)(n.state.collabServer);n.socket=a,a.on("presence",function(e){return n.receivePresenceData(e)}),a.on("repo_update",function(e){return n.receiveUpdateData(e)}),a.on("connect",function(){n.socket_id=a.id})}return n}return r(t,e),u(t,[{key:"receiveUpdateData",value:function(e){var t=this,n=new Date;parseFloat(n-this.lastModifyTime)/1e3<=5||Ze.fileMetaData().then(function(e){e.data.id!==t.state.fileInfo.id&&g.default.notify(d.default.createElement("span",null,(0,Z.gettext)("This file has been updated."),d.default.createElement("a",{href:""}," ",(0,Z.gettext)("Refresh"))),{id:"repo_updated",duration:3600})})}},{key:"receivePresenceData",value:function(e){switch(e.response){case"user_join":return void g.default.notify("user "+e.user.name+" joined",{duration:3});case"user_left":return void g.default.notify("user "+e.user.name+" left",{duration:3});case"update_users":for(var t in e.users)if(e.users.hasOwnProperty(t)&&t===this.socket_id){e.users[t].myself=!0;break}return void this.setState({collabUsers:Object.values(e.users)});case"user_editing":return void g.default.danger("user "+e.user.name+" is editing this file!",{duration:3});default:return void console.log("unknown response type: "+e.response)}}},{key:"componentWillUnmount",value:function(){this.socket.emit("repo_update",{request:"unwatch_update",repo_id:this.props.c.repoID,user:{name:Ze.name,username:Ze.username,contact_email:Ze.contact_email}}),document.removeEventListener("selectionchange",this.setBtnPosition)}},{key:"componentDidMount",value:function(){var e=this;if(h.seafileAPI.getFileInfo(te,ae).then(function(t){var n=t.data,a=n.mtime,o=n.size,r=n.starred,i=n.permission,s=n.last_modifier_name,u=n.id,c=s;e.setState(function(e,t){return{fileInfo:l({},e.fileInfo,{mtime:a,size:o,starred:r,permission:i,lastModifier:c,id:u})}}),h.seafileAPI.getFileDownloadLink(te,ae).then(function(t){var n=t.data;h.seafileAPI.getFileContent(n).then(function(t){var n=t.data.length,a=0===n||1===n,o="rw"===e.state.fileInfo.permission,r="edit"===re,i=(0,B.deserialize)(t.data);e.setState({markdownContent:t.data,loading:!1,editorMode:o&&(se||r&&!le||a&&!le)?"rich":"viewer",value:i})})})}),pe&&this.socket){var t=this.state.fileInfo,n=t.repoID,a=t.path;this.socket.emit("presence",{request:"join_room",doc_id:z.MD5(n+a).toString(),user:pe}),this.socket.emit("repo_update",{request:"watch_update",repo_id:Ze.repoID,user:{name:Ze.name,username:Ze.username,contact_email:Ze.contact_email}})}this.checkDraft(),this.listRelatedFiles(),this.listFileTags(),this.getCommentsNumber(),document.addEventListener("selectionchange",this.setBtnPosition),setTimeout(function(){new $(window.location.href).hash&&(window.location.href=window.location.href)},100)}},{key:"render",value:function(){var e=void 0,t=!!this.state.isShowHistory,n=t?"seafile-md-viewer-slate side-panel-on":this.state.isShowComments?"seafile-md-viewer-slate comment-on":"seafile-md-viewer-slate";return this.state.loading?d.default.createElement("div",{className:"empty-loading-page"},d.default.createElement("div",{className:"lds-ripple page-centered"},d.default.createElement("div",null),d.default.createElement("div",null))):"editor"===this.state.mode?(e="viewer"===this.state.editorMode?d.default.createElement("div",{className:"seafile-md-viewer d-flex flex-column"},d.default.createElement(k.default,{isDocs:Z.isDocs,hasDraft:le,isDraft:se,editorUtilities:Ze,collabUsers:this.state.collabUsers,fileInfo:this.state.fileInfo,toggleStar:this.toggleStar,backToParentDirectory:this.backToParentDirectory,openDialogs:this.openDialogs,fileTagList:this.state.fileTagList,relatedFiles:this.state.relatedFiles,toggleShareLinkDialog:this.toggleShareLinkDialog,onEdit:this.onEdit,toggleNewDraft:Ze.createDraftFile,commentsNumber:this.state.commentsNumber,toggleCommentList:this.toggleCommentList,showFileHistory:!this.state.isShowHistory,toggleHistory:this.toggleHistory}),d.default.createElement("div",{className:"seafile-md-viewer d-flex"},d.default.createElement("div",{className:t?"seafile-md-viewer-container side-panel-on":"seafile-md-viewer-container",ref:"markdownContainer"},this.state.isShowHistory?d.default.createElement("div",{className:"diff-container"},d.default.createElement("div",{className:"diff-wrapper article"},this.state.loadingDiff?d.default.createElement(q.default,null):d.default.createElement(G.default,{newMarkdownContent:this.state.markdownContent,oldMarkdownContent:this.state.oldMarkdownContent}))):d.default.createElement("div",{className:n},d.default.createElement(F.default,{relatedFiles:this.state.relatedFiles,siteRoot:ce,value:this.state.value}),this.state.isShowComments&&d.default.createElement("i",{className:"fa fa-plus-square seafile-viewer-comment-btn",ref:"commentbtn",onMouseDown:this.addComment})),this.state.isShowOutline&&d.default.createElement(j.default,{isViewer:!0,document:this.state.value.document,scrollToNode:this.scrollToNode}),this.state.isShowComments&&d.default.createElement(x.default,{toggleCommentPanel:this.toggleCommentList,commentsNumber:this.state.commentsNumber})),d.default.createElement("div",{className:"seafile-md-viewer-side-panel"},this.state.isShowHistory&&d.default.createElement(O.default,{editorUtilities:Ze,showDiffViewer:this.showDiffViewer,setDiffViewerContent:this.setDiffViewerContent,reloadDiffContent:this.reloadDiffContent,toggleHistoryPanel:this.toggleHistory})))):d.default.createElement(p.default,{fileInfo:this.state.fileInfo,markdownContent:this.state.markdownContent,editorUtilities:Ze,collabUsers:this.state.collabUsers,setFileInfoMtime:this.setFileInfoMtime,toggleStar:this.toggleStar,showFileHistory:!0,setEditorMode:this.setEditorMode,setContent:this.setContent,draftID:ie,isDraft:se,mode:this.state.mode,emitSwitchEditor:this.emitSwitchEditor,hasDraft:le,editorMode:this.state.editorMode,relatedFiles:this.state.relatedFiles,siteRoot:ce,autoSaveDraft:this.autoSaveDraft,setDraftValue:this.setDraftValue,clearTimer:this.clearTimer,openDialogs:this.openDialogs,fileTagList:this.state.fileTagList,deleteDraft:this.deleteDraft,showDraftSaved:this.state.showDraftSaved}),d.default.createElement(d.default.Fragment,null,this.state.localDraftDialog?d.default.createElement(J.default,null,d.default.createElement(N.default,{localDraftDialog:this.state.localDraftDialog,deleteDraft:this.deleteDraft,closeDraftDialog:this.closeDraftDialog,useDraft:this.useDraft})):null,e,this.state.showMarkdownEditorDialog&&d.default.createElement(d.default.Fragment,null,this.state.showEditFileTagDialog&&d.default.createElement(J.default,null,d.default.createElement(P.default,{repoID:te,filePath:ae,fileTagList:this.state.fileTagList,toggleCancel:this.toggleCancel,onFileTagChanged:this.onFileTagChanged})),this.state.showRelatedFileDialog&&d.default.createElement(J.default,null,d.default.createElement(T.default,{repoID:te,filePath:ae,relatedFiles:this.state.relatedFiles,toggleCancel:this.toggleCancel,onRelatedFileChange:this.onRelatedFileChange,dirent:this.state.fileInfo,viewMode:this.state.viewMode})),this.state.showInsertFileDialog&&d.default.createElement(J.default,null,d.default.createElement(H.default,{repoID:te,filePath:ae,toggleCancel:this.toggleCancel,getInsertLink:this.getInsertLink})),this.state.showShareLinkDialog&&d.default.createElement(J.default,null,d.default.createElement(v.default,{itemType:"file",itemName:this.state.fileInfo.name,itemPath:ae,repoID:te,toggleDialog:this.toggleCancel,isGroupOwnedRepo:!1,repoEncrypted:!1})),this.state.showCommentDialog&&d.default.createElement(J.default,null,d.default.createElement(b.default,{toggleCommentDialog:this.toggleCancel,editorUtilities:Ze,onCommentAdded:this.onCommentAdded,commentPosition:this.state.commentPosition,quote:this.quote}))))):void 0}}]),t}(d.default.Component);t.default=Se},58:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),f=n(6),p=a(f),m=n(82),h=n(5),Y=n(2),Z=n(3);n(59);var S=window.app.pageOptions,L=S.username,C=S.repoID,g=S.filePath,X={toggleCommentPanel:d.default.func.isRequired,commentsNumber:d.default.number},J=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleResolvedComment=function(){n.setState({showResolvedComment:!n.state.showResolvedComment})},n.listComments=function(){Z.seafileAPI.listComments(C,g).then(function(e){n.setState({commentsList:e.data.comments})})},n.handleCommentChange=function(e){n.setState({comment:e.target.value})},n.submitComment=function(){var e=n.refs.commentTextarea.value;e.trim()&&Z.seafileAPI.postComment(C,g,e).then(function(){n.listComments()}),n.refs.commentTextarea.value=""},n.resolveComment=function(e){Z.seafileAPI.updateComment(C,e.target.id,"true").then(function(){n.listComments()})},n.deleteComment=function(e){Z.seafileAPI.deleteComment(C,e.target.id).then(function(){n.listComments()})},n.editComment=function(e,t){Z.seafileAPI.updateComment(C,e,null,null,t).then(function(e){n.listComments()})},n.state={commentsList:[],showResolvedComment:!0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listComments()}},{key:"componentWillReceiveProps",value:function(e){this.props.commentsNumber!==e.commentsNumber&&this.listComments()}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"seafile-comment"},u.default.createElement("div",{className:"seafile-comment-title"},u.default.createElement("div",{onClick:this.props.toggleCommentPanel,className:"seafile-comment-title-close"},u.default.createElement("i",{className:"fa fa-times-circle"})),u.default.createElement("div",{className:"seafile-comment-title-text"},(0,Y.gettext)("Comments"))),u.default.createElement("div",{className:"seafile-comment-toggle-resolved"},u.default.createElement("div",{className:"seafile-comment-title-text"},(0,Y.gettext)("Show resolved comments")),u.default.createElement("div",{className:"seafile-comment-title-toggle d-flex"},u.default.createElement("label",{className:"custom-switch",id:"toggle-resolved-comments"},u.default.createElement("input",{type:"checkbox",name:"option",className:"custom-switch-input",onChange:this.toggleResolvedComment,checked:this.state.showResolvedComment&&"checked"}),u.default.createElement("span",{className:"custom-switch-indicator"})))),u.default.createElement("ul",{className:"seafile-comment-list"},this.state.commentsList.length>0&&this.state.commentsList.map(function(t){var n=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments[2],new Date(t.created_at).getTime()),a=(0,p.default)(n).format("YYYY-MM-DD HH:mm");return u.default.createElement(u.default.Fragment,{key:t.id},u.default.createElement(P,{item:t,time:a,deleteComment:e.deleteComment,resolveComment:e.resolveComment,editComment:e.editComment,showResolvedComment:e.state.showResolvedComment}))}),0==this.state.commentsList.length&&u.default.createElement("li",{className:"comment-vacant"},(0,Y.gettext)("No comment yet."))),u.default.createElement("div",{className:"seafile-comment-footer"},u.default.createElement("textarea",{className:"add-comment-input",ref:"commentTextarea",placeholder:(0,Y.gettext)("Add a comment."),clos:"100",rows:"3",warp:"virtual"}),u.default.createElement(h.Button,{className:"submit-comment",color:"success",size:"sm",onClick:this.submitComment},(0,Y.gettext)("Submit"))))}}]),t}(u.default.Component);J.propTypes=X;var D={time:d.default.string.isRequired,item:d.default.object.isRequired,deleteComment:d.default.func.isRequired,resolveComment:d.default.func.isRequired,showResolvedComment:d.default.bool.isRequired,editComment:d.default.func.isRequired},P=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleDropDownMenu=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.convertComment=function(e){m.processor.process(e).then(function(e){var t=String(e);n.setState({html:t})})},n.toggleEditComment=function(){n.setState({editable:!n.state.editable})},n.updateComment=function(e){var t=n.state.newComment;n.props.item.comment!==t&&n.props.editComment(e.target.id,t),n.toggleEditComment()},n.handleCommentChange=function(e){n.setState({newComment:e.target.value})},n.state={dropdownOpen:!1,html:"",newComment:n.props.item.comment,editable:!1},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.convertComment(this.props.item.comment)}},{key:"componentWillReceiveProps",value:function(e){this.convertComment(e.item.comment)}},{key:"render",value:function(){var e=this.props.item;return e.resolved&&!this.props.showResolvedComment?null:this.state.editable?u.default.createElement("li",{className:"seafile-comment-item",id:e.id},u.default.createElement("div",{className:"seafile-comment-info"},u.default.createElement("img",{className:"avatar",src:e.avatar_url,alt:""}),u.default.createElement("div",{className:"reviewer-info"},u.default.createElement("div",{className:"reviewer-name"},e.user_name),u.default.createElement("div",{className:"review-time"},this.props.time))),u.default.createElement("div",{className:"seafile-edit-comment"},u.default.createElement("textarea",{className:"edit-comment-input",value:this.state.newComment,onChange:this.handleCommentChange,clos:"100",rows:"3",warp:"virtual"}),u.default.createElement(h.Button,{className:"comment-btn",color:"success",size:"sm",onClick:this.updateComment,id:e.id},(0,Y.gettext)("Update"))," ",u.default.createElement(h.Button,{className:"comment-btn",color:"secondary",size:"sm",onClick:this.toggleEditComment}," ",(0,Y.gettext)("Cancel")))):u.default.createElement("li",{className:e.resolved?"seafile-comment-item seafile-comment-item-resolved":"seafile-comment-item",id:e.id},u.default.createElement("div",{className:"seafile-comment-info"},u.default.createElement("img",{className:"avatar",src:e.avatar_url,alt:""}),u.default.createElement("div",{className:"reviewer-info"},u.default.createElement("div",{className:"reviewer-name"},e.user_name),u.default.createElement("div",{className:"review-time"},this.props.time)),u.default.createElement(h.Dropdown,{isOpen:this.state.dropdownOpen,size:"sm",className:"seafile-comment-dropdown",toggle:this.toggleDropDownMenu},u.default.createElement(h.DropdownToggle,{className:"seafile-comment-dropdown-btn"},u.default.createElement("i",{className:"fas fa-ellipsis-v"})),u.default.createElement(h.DropdownMenu,null,e.user_email===L&&u.default.createElement(h.DropdownItem,{onClick:this.props.deleteComment,className:"delete-comment",id:e.id},(0,Y.gettext)("Delete")),e.user_email===L&&u.default.createElement(h.DropdownItem,{onClick:this.toggleEditComment,className:"edit-comment",id:e.id},(0,Y.gettext)("Edit")),!e.resolved&&u.default.createElement(h.DropdownItem,{onClick:this.props.resolveComment,className:"seafile-comment-resolved",id:e.id},(0,Y.gettext)("Mark as resolved"))))),u.default.createElement("div",{className:"seafile-comment-content",dangerouslySetInnerHTML:{__html:this.state.html}}))}}]),t}(u.default.Component);P.propTypes=D,t.default=J},59:function(e,t){},697:function(e,t){},699:function(e,t){},7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(15),o=function(e){return e&&e.__esModule?e:{default:e}}(a),r=new o.default;t.default=r},813:function(e,t){},814:function(e,t){},815:function(e,t){},816:function(e,t){},817:function(e,t){},818:function(e,t){},822:function(e,t){},86:function(e,t){},87:function(e,t){},88:function(e,t){},953:function(e,t){},98:function(e,t){}},[541]);
//# sourceMappingURL=markdownEditor.js.map